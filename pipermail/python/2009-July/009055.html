<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2009-July/009055.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:19:24 GMT -->
<HEAD>
   <TITLE> [python] sprava pameti,trida
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20sprava%20pameti%2Ctrida&In-Reply-To=%3C913F77222E913C49A057FDD7BBDEAAA3018E31BF%40br-dc.uhul.wan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2009-July/009054.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2009-July/009058.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] sprava pameti,trida</H1>
    <B>MICHÁLEK Jan Mgr.</B> 
    <A HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20sprava%20pameti%2Ctrida&In-Reply-To=%3C913F77222E913C49A057FDD7BBDEAAA3018E31BF%40br-dc.uhul.wan%3E"
       TITLE="[python] sprava pameti,trida">Michalek.Jan na uhul.cz
       </A><BR>
    <I>Ètvrtek Èervenec  9 10:28:52 CEST 2009</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2009-July/009054.html">[python] sprava pameti,trida
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2009-July/009058.html">[python] vypis promennych dane instance
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2009-July/date.html#9055">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2009-July/thread.html#9055">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2009-July/subject.html#9055">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2009-July/author.html#9055">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>No, já na o pou¾ívám fintu:
def __del__ (self):
	print: 'je to smazany'

Tak¾e vim, kdy to zmizlo

-----Original Message-----
From: <A HREF="http://www.py.cz/mailman/listinfo/python">python-bounces na py.cz</A> [mailto:<A HREF="http://www.py.cz/mailman/listinfo/python">python-bounces na py.cz</A>] On Behalf Of Petr Messner
Sent: Wednesday, July 08, 2009 4:19 PM
To: Konference PyCZ
Subject: Re: [python] sprava pameti,trida

2009/7/8 Petr Zlamal &lt;<A HREF="http://www.py.cz/mailman/listinfo/python">p.zlamal na gmail.com</A>&gt;:
&gt;<i> Pratele,
</I>&gt;<i> Potreboval bych poradit jak uvolnit pamet v pythonu, respektive jak 
</I>&gt;<i> odstranit nepotrebnou instanci tridy z pameti. Zkousel jsem prikaz 
</I>&gt;<i> del. Po provedeni &quot;del&quot; na instanci tridy je vsak pamet zaplnena furt 
</I>&gt;<i> stejne (sledovano pomoci top v linuxu). Mozna na to jdu uplne spatne. 
</I>&gt;<i> Vi nekdo jak provest uvolneni?
</I>
Po pou¾ití del se jen &quot;sma¾e&quot; promìnná a tím odstraní reference na daný objekt. Objekt se uvolní a¾ pokud na nìj nejsou ¾ádné reference (ihned nebo a¾ si toho v¹imne garbage collector, zále¾í na implementaci a okolnostech). Ale dejme tomu, ¾e se objekt skuteènì sma¾e, proto¾e jste zavolal del na jedinou referenci. Pak se pamì» uvolní, jen¾e se jedná o pamì», kterou má python alokovanou právì pro objekty, tedy se uvolní místo tøeba pro nový objekt; pamì» není vrácena operaènímu systému (= ¾ádná zmìna ve výpisu top), bylo by to neefektivní v¾dy vracet ka¾dý kousek uvolnìné pamìti a pak zase alokovat dal¹í (vlastnì celý tenhle problém je o kompromisech mezi výkonem a zabranou pamìtí, i volání malloc/free je dost drahé).

Pokud se ale takto nastøádá hodnì nevyu¾ité pamìti, interpreter se mù¾e rozhodnout tuto pamì» vrátit operaènímu systému. Ale zále¾í, jak bylo tato pamì» od operaèního systému získána (pokud je pou¾ita funkce malloc, zále¾í na implementaci v libc). Pokud se jedná o namapovanou pamì» (mmap) a celý blok pamìti (pøinejmen¹ím celá stránka) je nepotøebný, lze ho vrátit a hodnota v top se - koneènì - sní¾í. Pamì» lze od operaèního systému získat i jinými zpùsoby, to bych zde ale u¾ radìji nerozvádìl.

V dùsledku toho se mù¾e stát, ¾e pøi smazání velkého objektu se nemusí uvolnit tolik pamìti, kolik ten objekt zabíral. Pokud si s tím chcete hrát, doporuèuji strace :-)

To, co jsem teï napsal, je dost zjednodu¹ené a zobecnìné, napsal jsem to bez konkrétní znalosti vnitøností Pythonu, které se navíc s vývojem Pythonu a jeho interpreterù mìní. Mo¾ná se pletu. V prùbìhu psaní této odpovìdi Dan Pressl poslal odkaz na èlánek &quot;Python Memory Management&quot;, tam je detailù více, tøeba ¾e pro rùzné typy objektù existují rùzné alokátory a nìkteré z nich dokonce zabranou pamì» nevrací.

Mimochodem, nedávno se na Python mailing-listu ozval nìkdo s dotazem, jestli nelze mít objekt naalokovaný øeknìme dokud je volná pamì», ¾e by pak tøeba sám zmizel. Nelze :-) Lze ale pou¾ít tøeba memcache.

PM
_______________________________________________
Python mailing list
<A HREF="http://www.py.cz/mailman/listinfo/python">Python na py.cz</A>
<A HREF="http://www.py.cz/mailman/listinfo/python">http://www.py.cz/mailman/listinfo/python</A>
 

__________ Informace od ESET NOD32 Antivirus, verze databaze 4224 (20090708) __________

Tuto zpravu proveril ESET NOD32 Antivirus.

<A HREF="http://www.eset.cz/">http://www.eset.cz</A>
 
 

__________ Informace od ESET NOD32 Antivirus, verze databaze 4227 (20090709) __________

Tuto zpravu proveril ESET NOD32 Antivirus.

<A HREF="http://www.eset.cz/">http://www.eset.cz</A>
 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2009-July/009054.html">[python] sprava pameti,trida
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2009-July/009058.html">[python] vypis promennych dane instance
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2009-July/date.html#9055">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2009-July/thread.html#9055">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2009-July/subject.html#9055">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2009-July/author.html#9055">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2009-July/009055.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:19:24 GMT -->
</html>
