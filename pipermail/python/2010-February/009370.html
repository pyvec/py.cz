<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2010-February/009370.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:19:03 GMT -->
<HEAD>
   <TITLE> [python] python http
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20python%20http&In-Reply-To=%3C1b5f01caa945%24045ad660%246164a8c0%40xp%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2010-February/009366.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2010-February/009367.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] python http</H1>
    <B>Jaroslav Lukesh</B> 
    <A HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20python%20http&In-Reply-To=%3C1b5f01caa945%24045ad660%246164a8c0%40xp%3E"
       TITLE="[python] python http">lukesh na seznam.cz
       </A><BR>
    <I>Úterý Únor  9 06:02:00 CET 2010</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2010-February/009366.html">[python] python http
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2010-February/009367.html">[python] Utery 9. unora, 19:00, kanal #python-cs na siti FreeNode -- 1st CzSk Python Community Meetup
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2010-February/date.html#9370">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2010-February/thread.html#9370">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2010-February/subject.html#9370">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2010-February/author.html#9370">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>No a máte ty data a hlavièku skuteènì vpoøádku? Co¾ takhle si to pro 
kontrolu zobrazit?

----- Original Message ----- 
From: &quot;Szkandera.Karel&quot; &lt;<A HREF="http://www.py.cz/mailman/listinfo/python">Szkandera.Karel na seznam.cz</A>&gt;


Dìkuji za odpovìï, bohu¾el s tímto content-typem jsem to taky zkou¹el, ale 
nefunguje to. Pøi tomto zadání mi to vrátí chybovou stránku serveru &quot; v 
aplikaci nastali neoèekávaná chyba [callback/viewstate/mac]. Tento typ chyby 
vzniká, pokud nesouhlasí kontrolní mechanizmy aplikace zaji¹»ující 
konzistenci odeslaných a pøijatých interních aplikaèních dat na klienta a 
zpìt (odeslaná data nesouhlasí s daty pøijatými). &quot;


&gt;<i> Message: 2
</I>&gt;<i> Date: Sun, 07 Feb 2010 16:24:24 +0100
</I>&gt;<i> From: &quot;azurIt&quot; &lt;<A HREF="http://www.py.cz/mailman/listinfo/python">azurit na pobox.sk</A>&gt;
</I>&gt;<i>
</I>&gt;<i> len co som to zbezne pozrel, tak pri POST musi byt hlavicka Content-Type
</I>&gt;<i> nastavena na application/x-www-form-urlencoded
</I>&gt;<i>
</I>&gt;<i> azur
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &gt;-----Pôvodná správa-----
</I>&gt;<i> &gt;Od: Szkandera.Karel [mailto:<A HREF="http://www.py.cz/mailman/listinfo/python">Szkandera.Karel na seznam.cz</A>]
</I>&gt;<i> &gt;Komu: <A HREF="http://www.py.cz/mailman/listinfo/python">python na py.cz</A>
</I>&gt;<i> &gt;Predmet: [python] python http
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Ahoj,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;chci posilat pomoci pythonu automaticky data do jednoho formulare na webu 
</I>&gt;<i> &gt;a
</I>&gt;<i> nasledne odpoved zpracovat. Ikdyz bych rekl, ze by to melo jit, tak mi to
</I>&gt;<i> nevraci kyzeny vysledek. Chtel jsem, aby mi nasledujici skript vratil 
</I>&gt;<i> stranku s
</I>&gt;<i> vyplnenym katastralnim uzemim a kam bych mohl nasledne zadat vyplnit 
</I>&gt;<i> parcelni
</I>&gt;<i> cislo, ale vypada to, jakoby se ten POST nepovedl. Nevite v cem je chyba?
</I>&gt;<i> Dekuji
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;import httplib, urllib, urllib2, cookielib
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;#definice pouzivanych promennych
</I>&gt;<i> &gt;adresa = '<A HREF="http://m.nahlizenidokn.cuzk.cz/VyberParcelu.aspx">http://m.nahlizenidokn.cuzk.cz/VyberParcelu.aspx</A>'
</I>&gt;<i> &gt;cesta_k_vysledku='d:/python/cuzk/vysledek.html'
</I>&gt;<i> &gt;cislouzemi = '635561'
</I>&gt;<i> &gt;parcela = '1350'
</I>&gt;<i> &gt;headers = {'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
</I>&gt;<i> rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2','Content-type':
</I>&gt;<i> 'application/xhtml+xml'}
</I>&gt;<i> &gt;text = ''
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;#poslani metodou get + ziskani vildacniho kodu
</I>&gt;<i> &gt;conn = httplib.HTTPConnection(&quot;m.nahlizenidokn.cuzk.cz&quot;)
</I>&gt;<i> &gt;odpoved = conn.request(&quot;GET&quot;, &quot;/VyberParcelu.aspx&quot;, headers=headers)
</I>&gt;<i> &gt;r1 = conn.getresponse()
</I>&gt;<i> &gt;odpoved = r1.read()
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;x = odpoved.find('__VIEWSTATE&quot; value=&quot;')
</I>&gt;<i> &gt;y = len('__VIEWSTATE&quot; value=&quot;')
</I>&gt;<i> &gt;z = odpoved.find('&quot; /&gt;',x+y)
</I>&gt;<i> &gt;state = odpoved[x+y:z]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;x = odpoved.find('__EVENTVALIDATION&quot; value=&quot;')
</I>&gt;<i> &gt;y = len('id=&quot;__EVENTVALIDATION&quot; value=&quot;')
</I>&gt;<i> &gt;z = odpoved.find('&quot; /&gt;',x+y)
</I>&gt;<i> &gt;valid = odpoved[x+y:z]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;#poslani metodou POST
</I>&gt;<i> &gt;params = urllib.urlencode({'__VIEWSTATE' : state, '__EVENTVALIDATION' : 
</I>&gt;<i> &gt;valid
</I>&gt;<i> ,'ctl00$bodyPlaceHolder$vyberKU$btnKU' : 'Vyhledat' ,
</I>&gt;<i> 'ctl00$bodyPlaceHolder$vyberKU$txtKU' : cislouzemi})
</I>&gt;<i> &gt;headers = {'User-Agent': 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US;
</I>&gt;<i> rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2', 'Content-type':
</I>&gt;<i> 'application/xhtml+xml'}
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;conn.request(&quot;POST&quot;, &quot;/VyberParcelu.aspx&quot;, params, headers)
</I>&gt;<i> &gt;response = conn.getresponse()
</I>&gt;<i> &gt;print response.status, response.reason
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;#kontrolni vytisknuti odpovedi do souboru
</I>&gt;<i> &gt;data = response.read()
</I>&gt;<i> &gt;text=text + str(data)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;pridat = file(cesta_k_vysledku,'w')
</I>&gt;<i> &gt;pridat.write(text)
</I>&gt;<i> &gt;pridat.close()
</I>
_______________________________________________
Python mailing list
<A HREF="http://www.py.cz/mailman/listinfo/python">Python na py.cz</A>
<A HREF="http://www.py.cz/mailman/listinfo/python">http://www.py.cz/mailman/listinfo/python</A> 

</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2010-February/009366.html">[python] python http
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2010-February/009367.html">[python] Utery 9. unora, 19:00, kanal #python-cs na siti FreeNode -- 1st CzSk Python Community Meetup
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2010-February/date.html#9370">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2010-February/thread.html#9370">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2010-February/subject.html#9370">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2010-February/author.html#9370">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2010-February/009370.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:19:03 GMT -->
</html>
