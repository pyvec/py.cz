<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2012-August/010737.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:17:26 GMT -->
<HEAD>
   <TITLE> [python] ssh klient pro python
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20ssh%20klient%20pro%20python&In-Reply-To=%3CCAPy44ZXWJQOasVpov%3DZWpFpUiiXr9bhC7sheyAnx7KJmi8WjXA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2012-August/010736.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2012-August/010738.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] ssh klient pro python</H1>
    <B>Visgean Skeloru</B> 
    <A HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20ssh%20klient%20pro%20python&In-Reply-To=%3CCAPy44ZXWJQOasVpov%3DZWpFpUiiXr9bhC7sheyAnx7KJmi8WjXA%40mail.gmail.com%3E"
       TITLE="[python] ssh klient pro python">visgean na gmail.com
       </A><BR>
    <I>Nedìle Srpen 12 14:21:35 CEST 2012</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-August/010736.html">[python] ssh klient pro python
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-August/010738.html">[python] ssh klient pro python
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2012-August/date.html#10737">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-August/thread.html#10737">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-August/subject.html#10737">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-August/author.html#10737">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ahoj, vím ¾e na SSH - hlavnì na správu serverù se hodnì pou¾ívá
<A HREF="http://fabfile.org/">http://fabfile.org/</A> , mo¾ná bvy to fungovalo lépe

2012/8/12 &quot;Ing. Vladislav Ludík&quot; &lt;<A HREF="http://www.py.cz/mailman/listinfo/python">vlada na ludik.cz</A>&gt;

&gt;<i> Zdravím v¹echny,
</I>&gt;<i>
</I>&gt;<i> narazil jsem na problém, který se týká nespolehlivého ssh klienta z modulu
</I>&gt;<i> paramiko.
</I>&gt;<i>
</I>&gt;<i> Kdy¾ pomocí nìj ètu data napøíklad z nìkterých verzí Mikrotiku,
</I>&gt;<i> napøíklad MikroTik RouterOS 5.17, stane se obèas, ¾e nedostanu kompletní
</I>&gt;<i> data.
</I>&gt;<i> Nìkdy naète v¹e, nìkdy jen nìco. Jak kdy.
</I>&gt;<i> Pokud se pøipojím pøes PuTTy, je pøenos v¾dy spolehlivý.
</I>&gt;<i> Mùj modul, který pak pou¾ívám v mých programech je v pøíloze.
</I>&gt;<i> Neví nìkdo kde bych mìl hledat problém, popøípadì o spolehlivìj¹ím
</I>&gt;<i> klientovi ?
</I>&gt;<i>
</I>&gt;<i> Dìkuji V.L.
</I>&gt;<i>
</I>&gt;<i> &quot;&quot;&quot;Modul pro zadavani prikazu pres ssh&quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i> import paramiko
</I>&gt;<i> import cmd
</I>&gt;<i> import string
</I>&gt;<i>
</I>&gt;<i> class RunCommand(cmd.Cmd):
</I>&gt;<i>         &quot;&quot;&quot; Jednoduchy shell pro zadavani prikazu na adresu host &quot;&quot;&quot;
</I>&gt;<i>
</I>&gt;<i>         prompt = 'ssh &gt; '
</I>&gt;<i>
</I>&gt;<i>         def __init__(self):
</I>&gt;<i>                 cmd.Cmd.__init__(self)
</I>&gt;<i>                 self.hosts = []
</I>&gt;<i>                 self.connections = []
</I>&gt;<i>
</I>&gt;<i>         def do_add_host(self, args):
</I>&gt;<i>                 &quot;&quot;&quot;add_host &lt;host,user,password,port&gt;
</I>&gt;<i>                 Prida adresu host do seznamu &quot;&quot;&quot;
</I>&gt;<i>                 if args:
</I>&gt;<i>                         self.hosts.append(args.split(','))
</I>&gt;<i>                 else:
</I>&gt;<i>                         print &quot;pouziti: host &lt;hostip,user,password,port&gt;&quot;
</I>&gt;<i>
</I>&gt;<i>         def do_connect(self, args):
</I>&gt;<i>                 &quot;&quot;&quot; Pripoji se ke vsem adresam host ze seznamu &quot;&quot;&quot;
</I>&gt;<i>                 for host in self.hosts:
</I>&gt;<i>                         ipcko, user, pswd, port = host
</I>&gt;<i>                         user = string.strip(user)
</I>&gt;<i>                         pswd = string.strip(pswd)
</I>&gt;<i>                         port = int(string.strip(port))
</I>&gt;<i>
</I>&gt;<i>                         client = paramiko.SSHClient()
</I>&gt;<i>                         client.set_missing_host_key_policy(
</I>&gt;<i>                                 paramiko.AutoAddPolicy())
</I>&gt;<i>                         client.connect(ipcko,
</I>&gt;<i>                                 username=user,
</I>&gt;<i>                                 password=pswd,
</I>&gt;<i>                                 port=port)
</I>&gt;<i>                         self.connections.append(client)
</I>&gt;<i>
</I>&gt;<i>         def do_run(self, command):
</I>&gt;<i>                 &quot;&quot;&quot;run &lt;command&gt;
</I>&gt;<i>                 Provede tento prikaz pro vsechny pripojene adresy ze
</I>&gt;<i> seznamu &quot;&quot;&quot;
</I>&gt;<i>                 if command:
</I>&gt;<i>                         for host, conn in zip(self.hosts,
</I>&gt;<i> self.connections):
</I>&gt;<i>                                 stdin, stdout, stderr =
</I>&gt;<i> conn.exec_command(command)
</I>&gt;<i>                                 out = stdout.read()
</I>&gt;<i>                                 err = stderr.read()
</I>&gt;<i>                                 stdout.close()
</I>&gt;<i>                                 stderr.close()
</I>&gt;<i>                                 return out, err
</I>&gt;<i>                 else:
</I>&gt;<i>                         print &quot;pouziti: run &lt;command&gt;&quot;
</I>&gt;<i>
</I>&gt;<i>         def do_close(self, args):
</I>&gt;<i>                 for conn in self.connections:
</I>&gt;<i>                         conn.close()
</I>&gt;<i>
</I>&gt;<i> #!/usr/bin/python
</I>&gt;<i> # -*- coding: utf-8 -*-
</I>&gt;<i>
</I>&gt;<i> from ssh import *
</I>&gt;<i>
</I>&gt;<i> def doSSH(host, cmd, user=_user, pswd=_pswd, port=_port):
</I>&gt;<i>     'Provedeni prikazu SSH'
</I>&gt;<i>
</I>&gt;<i>     con = ['%s,%s,%s,%s' % (host, user, pswd, port)]
</I>&gt;<i>     ssh = RunCommand()
</I>&gt;<i>     ssh.do_add_host(con[0])
</I>&gt;<i>     ssh.do_connect(con)
</I>&gt;<i>     stdout, stderr = ssh.do_run(cmd)
</I>&gt;<i>     ssh.do_close(con)
</I>&gt;<i>
</I>&gt;<i>     return stdout, stderr
</I>&gt;<i>
</I>&gt;<i> # atd.....
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Python mailing list
</I>&gt;<i> <A HREF="http://www.py.cz/mailman/listinfo/python">Python na py.cz</A>
</I>&gt;<i> <A HREF="http://www.py.cz/mailman/listinfo/python">http://www.py.cz/mailman/listinfo/python</A>
</I>&gt;<i>
</I>


-- 
GPG pub key&lt;<A HREF="http://keyserver.pgp.com/vkd/SubmitSearch.event?SearchCriteria=visgean%40gmail.com">http://keyserver.pgp.com/vkd/SubmitSearch.event?SearchCriteria=visgean%40gmail.com</A>&gt;
 | github/visgean &lt;<A HREF="http://github.com/Visgean">http://github.com/Visgean</A>&gt; | jabber &lt;<A HREF="http://www.py.cz/mailman/listinfo/python">visgean na jabber.cz</A>&gt;
------------- dal¹í èást ---------------
HTML pøíloha byla odstranìna...
URL: &lt;<A HREF="http://www.py.cz/pipermail/python/attachments/20120812/d8b95597/attachment.html">http://www.py.cz/pipermail/python/attachments/20120812/d8b95597/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-August/010736.html">[python] ssh klient pro python
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-August/010738.html">[python] ssh klient pro python
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2012-August/date.html#10737">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-August/thread.html#10737">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-August/subject.html#10737">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-August/author.html#10737">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2012-August/010737.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:17:26 GMT -->
</html>
