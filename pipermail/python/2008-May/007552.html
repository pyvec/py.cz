<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2008-May/007552.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:21:25 GMT -->
<HEAD>
   <TITLE> [python] py2exe dll export
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=%5Bpython%5D%20py2exe%20dll%20export&In-Reply-To=bd9056300805300928w4e910320s7d470cf662d2b6f5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2008-May/007551.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2008-May/007558.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] py2exe dll export</H1>
    <B>superman</B> 
    <A HREF="mailto:python%40py.cz?Subject=%5Bpython%5D%20py2exe%20dll%20export&In-Reply-To=bd9056300805300928w4e910320s7d470cf662d2b6f5%40mail.gmail.com"
       TITLE="[python] py2exe dll export">feed na centrum.cz
       </A><BR>
    <I>Pátek Kvìten 30 18:50:17 CEST 2008</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2008-May/007551.html">[python] py2exe dll export
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2008-May/007558.html">[python] py2exe dll export
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2008-May/date.html#7552">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2008-May/thread.html#7552">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2008-May/subject.html#7552">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2008-May/author.html#7552">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> &gt;Vymyslel jsem dva postupy, ale ani u jednoho jsem nebyl dostatecne 
uspesny:
 &gt;a) Puvodni zamer byl udelat v Ccku skeleton DLL knihovny a v ni pomoci
 &gt;elmeru (<A HREF="http://elmer.sourceforge.net/">http://elmer.sourceforge.net/</A>) zapouzdrit python kod. To temer 
fungovalo.

A nebylo by jednodu¹¹í rovnou pou¾ít Python C API? Podle mì by to nebylo
tak tì¾ké zapouzdøit tìch pár funkcí.

 &gt;b) Druhy postup predpoklada, ze jsem schopny pomoci py2exe vytvorit
 &gt;DLL knihovnu primo z cisteho python kodu. I zde jsem byl uspesny a povedlo
 &gt;se mi zkompilovat DLL knihovnu. Kdyz se ale podivam na exporty, ktere ta
 &gt;knihovna ma, vidim tam pouze zakladni DllRegisterServer, DllGetClassObject
 &gt;a dalsi, ktere ma kazdy COM DLL. Hloubam tady nad tim uz kolik hodin,
 &gt;Google moc nepomohl (asi to moc lidi nepotrebuje) a nevim, jak tam dostat
 &gt;sve vlasni exporty. Zajimave je, ze uvnitr kodu te DLL knihovny existuje
 &gt;retezec &quot;Vysledek&quot;, takze to ten skript my_com_server.py (viz. priloha)
 &gt;s funkcemi obsahuje.

Co¾ je naprosto v poøádku, proto¾e COM nepotøebuje exportovat funkce
jako DLL exporty, proto¾e COM mechanismus má svùj vlastní mechanismus
binárnì pøenostitelných objektù s metodami. Tak¾e to co jste získal je zcela
správné.

COM server musíte ve Windows zaregistrovat pomocí utilitky comsrv32.exe.

Abych vysvìtlil COM funguje tak, ¾e vytváøí pøenositelné tøídy (jejich¾ 
binární
rozhraní je pøesnì urèeno, tak¾e tuto tøídu mù¾ete pou¾ít v jakémkoli
programovacím jazyce). COM server tedy exportuje nìkolik rùznch tøíd,
v øeèi COMu zvaných interface a ani ty tøídy nexportuje na úrovni DLL, 
ale má
k tomu svùj vlastní mechanismus pomocí volání Windows API funkcí zaèínající
na Co* - a kterými dostanete v¹e potøebné - tedy v C ukazatel na objekt dané
tøídy (interface), a tím tedy i na virtuální tabulku metod této tøídy, 
pøes kterou
dané metody tøídy voláte. Musíte pøedem znát, jaká je struktura tøídy, pokud
to nechcete slo¾itìji zji¹»ovat pomocí typové knihovny.

Osobnì si myslím, ¾e bez bli¾¹ích znalostí kolem COM zále¾itostí v C (pokud
tedy tím druhým bindovaným jazykem je C) cestu b)
rovnou vzdejte. Pokud chcete Python nabindovat s jazykem s dobrou podporou
COMu (Visual Basic, Microsoft Office, Delphi, C++ Builder, C#, atd..) pak
je to primitivní.

Miloslav Ponkrác
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2008-May/007551.html">[python] py2exe dll export
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2008-May/007558.html">[python] py2exe dll export
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2008-May/date.html#7552">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2008-May/thread.html#7552">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2008-May/subject.html#7552">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2008-May/author.html#7552">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2008-May/007552.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:21:25 GMT -->
</html>
