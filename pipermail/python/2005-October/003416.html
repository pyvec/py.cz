<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2005-October/003416.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:26:27 GMT -->
<HEAD>
   <TITLE> RE: [python] Detekce kodovani zadaneho vstupu (bylo RE: soubor v jiné zankové sadì)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=%3D%3Fiso-8859-2%3FQ%3FRE%3D3A_%3D5Bpython%3D5D_Detekce_kodovani_zadaneho_vstupu_%3D28byl%3F%3D%0A%09%3D%3Fiso-8859-2%3FQ%3Fo_RE%3D3A_soubor_v_jin%3DE9_zankov%3DE9_sad%3DEC%3D29%3F%3D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2005-October/003415.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2005-October/003421.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>RE: [python] Detekce kodovani zadaneho vstupu (bylo RE: soubor v jiné zankové sadì)</H1>
    <B>Petr Prikryl</B> 
    <A HREF="mailto:python%40py.cz?Subject=%3D%3Fiso-8859-2%3FQ%3FRE%3D3A_%3D5Bpython%3D5D_Detekce_kodovani_zadaneho_vstupu_%3D28byl%3F%3D%0A%09%3D%3Fiso-8859-2%3FQ%3Fo_RE%3D3A_soubor_v_jin%3DE9_zankov%3DE9_sad%3DEC%3D29%3F%3D&In-Reply-To="
       TITLE="RE: [python] Detekce kodovani zadaneho vstupu (bylo RE: soubor v jiné zankové sadì)">PrikrylP na skil.cz
       </A><BR>
    <I>Ètvrtek Øíjen  6 08:59:11 CEST 2005</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2005-October/003415.html">[python] Plone: Existuje v zope nieco ako symbolicky link?
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2005-October/003421.html">Re: [python] Detekce kodovani zadaneho vstupu (bylo RE: soubor v jiné zankové sadì)
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2005-October/date.html#3416">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2005-October/thread.html#3416">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2005-October/subject.html#3416">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2005-October/author.html#3416">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dal¹í poznatky k pøevodu argv na unicode pod Windows
-- viz dole...

pepr
&gt;<i> &gt; geon
</I>&gt;<i> &gt; &gt; pepr
</I>&gt;<i> &gt; &gt; &gt;    cesta = unicode(raw_input(), sys.stdin.encoding)
</I>&gt;<i> &gt; &gt; kdy¾ to udìlám takto, tak mi to nefunguje (v DOSU). Pí¹e to :
</I>&gt;<i> &gt; &gt; C:\Admin\update&gt;deltree_xp.py c:\ì¹èø¾ýáí
</I>&gt;<i> &gt; &gt; Traceback (most recent call last):
</I>&gt;<i> &gt; &gt;   File &quot;C:\Admin\update\deltree_xp.py&quot;, line 36, in ?
</I>&gt;<i> &gt; &gt; [...]
</I>&gt;<i> &gt; &gt; WindowsError: [Errno 3] SystÚm nem¨×e nalÚzt uvedenou cestu: 
</I>&gt;<i> &gt; &gt; u'c:\\\xfd\xdc\u0154\xb0\xd7\u0159\xdf\xdd/*.*'
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Kdy¾ tam ale natvrdo dám místo sys.stdin.encoding --- 
</I>&gt;<i> &gt; &gt; &quot;cp1250&quot;, tak to jede bez problémù...nevím proè....
</I>&gt;<i> 
</I>&gt;<i> [...] vypadá to, ¾e v tomto pøípadì se pøi naèítání argv
</I>&gt;<i> bude vnitønì pou¾ívat kódování, které mù¾u zjistit
</I>&gt;<i> voláním sys.getdefaultencoding() 
</I>[...]
&gt;<i> Nedávno se objevil pokus o implementaci sys.argvu, 
</I>&gt;<i> co¾ mìl být ekvivalent sys.argv v unicode [...] smeteno
</I>&gt;<i> ze stolu. [...]
</I>
Zeptal jsem se v comp.lang.python (trochu nepøesnì, ale
jsou tam chytøí ho¹i): 

What encoding is used when initializing sys.argv?

&gt;<i> I know about the rejected attempt to implement
</I>&gt;<i> sys.argvu. Still, how the sys.argv is filled? What
</I>&gt;<i> encoding is used when parsing the cmd line internally?
</I>&gt;<i> To what encoding is it converted when non ASCII
</I>&gt;<i> characters appear?
</I>
Jádro odpovìdi je následující:

Martin v. Löwis
&gt;<i> 
</I>&gt;<i> Python does not perform any conversion whatsoever.
</I>&gt;<i> It has a traditional main() function, with the
</I>&gt;<i> char *argv[] argument.
</I>&gt;<i> 
</I>&gt;<i> So if you think that the arguments are inherently
</I>&gt;<i> Unicode on your system, your question should be
</I>&gt;<i> &quot;how does my operating system convert the
</I>&gt;<i> arguments&quot;?
</I>&gt;<i> 
</I>&gt;<i> That, of course, depends on your operating system.
</I>&gt;<i> &quot;MS Windows environment&quot; is not precise enough,
</I>&gt;<i> since it also depends on the specific incarnation
</I>&gt;<i> of that environment. On Windows 9x, I believe the
</I>&gt;<i> command line arguments are &quot;inherently&quot; *not* in
</I>&gt;<i> Unicode, but in a char array. On Windows NT+, they
</I>&gt;<i> are Unicode, and Windows (or is it the MS VC
</I>&gt;<i> runtime?) converts them to characters using the
</I>&gt;<i> CP_ACP code page.
</I>
Neil Hodgson:
&gt;<i> 
</I>&gt;<i> Martin mentioned CP_ACP. In Python on Windows,
</I>&gt;<i> this can be accessed as the &quot;mbcs&quot; codec.
</I>&gt;<i> 
</I>&gt;<i> import sys
</I>&gt;<i> print repr(sys.argv[1])
</I>&gt;<i> print repr(unicode(sys.argv[1], &quot;mbcs&quot;))
</I>&gt;<i> 
</I>&gt;<i> C:\bin&gt;python glurp.py abcß*
</I>&gt;<i> 'abc\xdf\x95'
</I>&gt;<i> u'abc\xdf\u2022'
</I>
Tak¾e úprava tvého skriptu (geon) by mohla vypadat 
takto: 
     cesta = unicode(sys.argv[1], &quot;mbcs&quot;)


pepr

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2005-October/003415.html">[python] Plone: Existuje v zope nieco ako symbolicky link?
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2005-October/003421.html">Re: [python] Detekce kodovani zadaneho vstupu (bylo RE: soubor v jiné zankové sadì)
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2005-October/date.html#3416">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2005-October/thread.html#3416">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2005-October/subject.html#3416">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2005-October/author.html#3416">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2005-October/003416.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:26:27 GMT -->
</html>
