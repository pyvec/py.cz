<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2007-February/005484.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:23:29 GMT -->
<HEAD>
   <TITLE> [python] Problem s regularnym vyrazom
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=%5Bpython%5D%20Problem%20s%20regularnym%20vyrazom&In-Reply-To=OFF26D022F.FEA471F4-ONC1257276.002B90F1-C1257276.002DC67D%40pds.sk">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2007-February/005481.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2007-February/005485.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] Problem s regularnym vyrazom</H1>
    <B>Jan Janech</B> 
    <A HREF="mailto:python%40py.cz?Subject=%5Bpython%5D%20Problem%20s%20regularnym%20vyrazom&In-Reply-To=OFF26D022F.FEA471F4-ONC1257276.002B90F1-C1257276.002DC67D%40pds.sk"
       TITLE="[python] Problem s regularnym vyrazom">devel na atlas.sk
       </A><BR>
    <I>Pátek Únor  2 13:38:26 CET 2007</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2007-February/005481.html">[python] Problem s regularnym vyrazom
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2007-February/005485.html">[python] Problem s regularnym vyrazom
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2007-February/date.html#5484">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2007-February/thread.html#5484">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2007-February/subject.html#5484">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2007-February/author.html#5484">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://www.py.cz/mailman/listinfo/python">RMiklos na pss.sk</A> wrote:
&gt;<i> Predtym som cital ( 
</I>&gt;<i> <A HREF="http://www.onlamp.com/pub/a/python/2006/01/26/pyparsing.html">http://www.onlamp.com/pub/a/python/2006/01/26/pyparsing.html</A> ) o module 
</I>&gt;<i> pyparsing  ( <A HREF="http://pyparsing.wikispaces.com/">http://pyparsing.wikispaces.com/</A>), ale zial nemal som cas sa 
</I>&gt;<i> s tym zaoberat. Doteraz parsujem vsetko iba regularnymi vyrazmi. Zda sa mi 
</I>&gt;<i> to najrychlejsie riesenie - i ked nie najlepsie a ma to tiez svoje hranice 
</I>&gt;<i> a uskalia.
</I>&gt;<i> 
</I>&gt;<i> Dik za info -o  yapps-e som doteraz nepocul. 
</I>&gt;<i> Nevidim dokumetaciu Yappsu na tej stranke. preto sa chcem spytat: 
</I>&gt;<i> 1. aky  je vstup pre Yapps? Nejako zapisana gramatika?
</I>&gt;<i> 2. pouzil si Yapps1 alebo Yapps2
</I>&gt;<i> 3. Nemas nejaky kratky priklad ako si parsoval to SQL?
</I>&gt;<i> 
</I>&gt;<i> s pozdravom
</I>&gt;<i> 
</I>&gt;<i> Roman
</I>
caw... kedysi som robil alter script generator pre mysql. nechcem to
prikladat do prilohy, neviem ci by to preslo cez mailing list, tak som
to vyvesil na <A HREF="http://st.fri.utc.sk/~janech/SQLAlterGenerator.tgz">http://st.fri.utc.sk/~janech/SQLAlterGenerator.tgz</A>
Pre teba je dolezity subor generator/SQLParser.g

Ja som pred tym tiez parsoval vsetko cez regulare... ale hento mi dava
omnoho viac moznosti

&gt;<i> Na taketo veci sa hodia skor parser-generatory ako regularne vyrazy. Ja 
</I>&gt;<i> pouzivam YAPPS (<A HREF="http://theory.stanford.edu/~amitp/yapps/">http://theory.stanford.edu/~amitp/yapps/</A>). Konkretne SQL 
</I>&gt;<i> som s nim uz parsoval.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://www.py.cz/mailman/listinfo/python">RMiklos na pss.sk</A> wrote:
</I>&gt;&gt;<i> Rad by som tymto oslovil odbornikov na regularne vyrazy.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Extrahujem datove polia tabulky cez regularny vyraz takto:
</I>&gt;&gt;<i> --------------------------- skript ---------------------------
</I>&gt;&gt;<i> import sys,re
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> sql_statement='''CREATE TABLE IBPDDB071/R004660V
</I>&gt;&gt;<i> (PERSONNR    DECIMAL     (10, 0)    NOT NULL WITH DEFAULT, LFDNR1 
</I>&gt;<i> DECIMAL 
</I>&gt;&gt;<i>   (3, 0)     NOT NULL WITH DEFAULT, VOTYP       CHARACTER   (1) NOT 
</I>&gt;&gt;<i> NULL WITH DEFAULT, BSSTAMMNR   DECIMAL     (7, 0)     NOT NULL WITH 
</I>&gt;&gt;<i> DEFAULT,BSVNR       DECIMAL     (2, 0)     NOT NULL WITH DEFAULT );'''
</I>&gt;&gt;<i> regexp_sql_create=\
</I>&gt;&gt;<i> re.compile(r&quot;^\s*CREATE\s+TABLE\s+&quot;
</I>&gt;&gt;<i>            r&quot;(?P&lt;library&gt;[A-Z0-9]+)\s*[/.]\s*(?P&lt;file&gt;[A-Z0-9]+)\s*&quot;
</I>&gt;&gt;<i>            r&quot;\((?P&lt;tbl_field_def&gt;.*)\)\s*&quot;)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> result=regexp_sql_create.search(sql_statement)
</I>&gt;&gt;<i> if result == None:
</I>&gt;&gt;<i>   # CREATE TABLE statement not valid ! 
</I>&gt;&gt;<i>   print &quot;SQL CREATE TABLE statement is not valid !!!&quot;
</I>&gt;&gt;<i>   sys.exit()
</I>&gt;&gt;<i> else:
</I>&gt;&gt;<i>   # Parse data from RegExp
</I>&gt;&gt;<i>   library=result.group('library')
</I>&gt;&gt;<i>   print &quot;Library=%s&quot; % library
</I>&gt;&gt;<i>   table=result.group('file')
</I>&gt;&gt;<i>   print &quot;Table=%s&quot; %table
</I>&gt;&gt;<i>   table_field_def=result.group('tbl_field_def')
</I>&gt;&gt;<i>   print &quot;Field Definitions=%s&quot; % table_field_def
</I>&gt;&gt;<i> ------------------------ konec skriptu ------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Potom definicie dat. poli dalej pracovavam. 
</I>&gt;&gt;<i> Toto by fungovalo, az na to ze SQL-skript je vygenerovany a okrem CREATE 
</I>&gt;<i> 
</I>&gt;&gt;<i> TABLE (...); moze obsahovat aj LABEL ON (...);
</I>&gt;&gt;<i> takze moze vyzerat takto:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> sql_statement='''CREATE TABLE IBPDDB071/R004660V
</I>&gt;&gt;<i> (PERSONNR    DECIMAL     (10, 0)    NOT NULL WITH DEFAULT, LFDNR1 
</I>&gt;<i> DECIMAL 
</I>&gt;&gt;<i>   (3, 0)     NOT NULL WITH DEFAULT, VOTYP       CHARACTER   (1) NOT 
</I>&gt;&gt;<i> NULL WITH DEFAULT, BSSTAMMNR   DECIMAL     (7, 0)     NOT NULL WITH 
</I>&gt;&gt;<i> DEFAULT,BSVNR       DECIMAL     (2, 0)     NOT NULL WITH DEFAULT ); 
</I>&gt;<i> Label 
</I>&gt;&gt;<i> on IBPDDB071/R004660V(PERSONNR   IS 'PERSONNR', LFDNR1     IS 'LFDNR1', 
</I>&gt;&gt;<i> VOTYP      IS 'VOTYP', BSSTAMMNR  IS 'BSSTAMMNR', BSVNR      IS 
</I>&gt;&gt;<i> 'BSVNR');'''
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Vtedy mi horeuvedeny regexp matchuje (pretoze je greedy) vsetko, takze 
</I>&gt;&gt;<i> rozpozna vsetko od 'CREATE TABLE(' az po poslednu zatvorku ')' stringu 
</I>&gt;&gt;<i> t.j. '..); LABEL ON(..' ale ja potrebujem aby rozpoznal len to co je v 
</I>&gt;&gt;<i> tele CREATE TABLE. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Vie mi niekto poradit ako napisat ten regularny vyraz aby robil co 
</I>&gt;&gt;<i> potrebujem?
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2007-February/005481.html">[python] Problem s regularnym vyrazom
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2007-February/005485.html">[python] Problem s regularnym vyrazom
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2007-February/date.html#5484">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2007-February/thread.html#5484">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2007-February/subject.html#5484">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2007-February/author.html#5484">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2007-February/005484.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:23:29 GMT -->
</html>
