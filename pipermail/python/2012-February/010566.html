<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2012-February/010566.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:17:38 GMT -->
<HEAD>
   <TITLE> [python] socket + udp + vytváøení paketù
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%0A%09%3D%3Fiso-8859-2%3Fq%3Fsocket_%2B_udp_%2B_vytv%3DE1%3DF8en%3DED_paket%3DF9%3F%3D&In-Reply-To=%3C4F43F6C9.3060908%40seznam.cz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2012-February/010565.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2012-February/010567.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] socket + udp + vytváøení paketù</H1>
    <B>Jakub Vojáèek</B> 
    <A HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%0A%09%3D%3Fiso-8859-2%3Fq%3Fsocket_%2B_udp_%2B_vytv%3DE1%3DF8en%3DED_paket%3DF9%3F%3D&In-Reply-To=%3C4F43F6C9.3060908%40seznam.cz%3E"
       TITLE="[python] socket + udp + vytváøení paketù">jakohv na seznam.cz
       </A><BR>
    <I>Úterý Únor 21 20:55:53 CET 2012</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-February/010565.html">[python] socket + udp + vytváøení paketù
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-February/010567.html">[python] socket + udp + vytváøení paketù
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2012-February/date.html#10566">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-February/thread.html#10566">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-February/subject.html#10566">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-February/author.html#10566">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dobrý den,

v zadání je uvedeno, ¾e indikátor spojení a sekvenèní èíslo je v 
reprezentaci network byte order (big endian) - znamená to tedy, ¾e ten 
zbytek mám reprezentovat v little endian?

data jsem zkou¹el balit s paddingem i bez paddingu, ani jednou server 
neodpovìdìl, tak¾e to asi nehraje roli (i kdy¾ jako korektní øe¹ení se 
mi zdá pou¾ít tu verz bez paddingu). Pomocí wiresharku jsem vysniffoval 
ten packet a má obsah

f8 d1 11 a2 4f 2c 48 5d  60 85 3e d8 08 00 45 00
00 26 0c 13 00 00 80 11  f1 d4 c0 a8 00 69 93 20
e8 ad e7 a7 0f a0 00 12  ca 71 00 00 00 00 00 00
00 00 01 31

Ale ty data jsou nìjak zakódována a popravdì se v nich moc nevyznám. 
Referenèní øe¹ení, které by fungovalo a jeho¾ pakety bych mohl 
vysniffovat bohu¾el nemám.

Pøístup k serveru mám, ale pouze vzdálený (be¾í na 147.32.232.173:4000), 
ale proto¾e tahle úloha je udìlána tak, aby se programovala v C nebo v 
Jave, tak ¾ádné testovací rozhraní, které by mi øeklo, co je ¹patnì 
neexistuje (Python jsem si mohl zvolit, ov¹em bylo mi øeèeno, ¾e musím 
poèítat s &quot;nulovou&quot; podporou ze strany ¹koly. Mám tedy pouze k dispozici 
refernèní výstup programu, kde se klient pøipojuje k serveru:

232 00000000*SEND*127.0.0.1:4000 seq=0 ack=0 flags=01 data(1): 
01                                        = zpráva zaslaná klientem
311 8CB60002*RECV*127.0.0.1:4000 seq=768 ack=0 flags=00 data(256): d0 93 
9a 0e 35 da 0b 9e ... 08 0a e0 08 4c 33 37 c9   =   odpovìd zaslaná 
serverem (tu právì nedostávám)

Bohu¾el celé to zadání je trochu zmatené. Je øeèeno, ¾e pøíznak má být 
první zprávy nastaven na SYN a je tam tabulka:
èíslo bitu 	7 	6 	5 	4 	3 	2 	1 	0
pøíznak 	- 	- 	- 	- 	- 	RST 	FIN 	SYN

A nyní mi tedy není  úplnì jasné, jestli pøíznaku syn odpovída èíslo 
000000001 = 1

Vypadá to, ¾e asi nakonec budu nucen pou¾ít nìkterý z podporovaných jazykù.

Dìkuji za Va¹e názory

Jakub


Dne 21.2.2012 19:52, Petr Messner napsal(a):
&gt;<i> Ahoj,
</I>&gt;<i>
</I>&gt;<i> 21. 2. 2012 v 19:19, Jakub Vojáèek:
</I>&gt;<i> ...
</I>&gt;&gt;<i> Pokud bych nemìl definován tvar paketu, tak bych pou¾il
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM )
</I>&gt;&gt;<i> s.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)
</I>&gt;&gt;<i> s.sendto(data, host, port))
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> , ale jeliko¾ je pøesnì definována velikost a struktura paketu, tak tento zpùsob nemohu pou¾ít.
</I>&gt;<i> Nerozumím tomu, proè tento zpùsob nemù¾e¹ pou¾ít. Jediné, co potøebuje¹ upravit, jsou data. Jak ten paket chce¹ potom odeslat, kdy¾ ne takto?
</I>&gt;<i>
</I>&gt;&gt;<i> Formát je definován následovnì:
</I>&gt;&gt;<i> - 4B jsou rezervovány na identifikátor spojení
</I>&gt;&gt;<i> - 2B jsou rezervovány na sekvenèní èíslo
</I>&gt;&gt;<i> - 2B jsou rezervovány na èíslo potvrzení
</I>&gt;&gt;<i> - 1B je rezervován na pøíznak
</I>&gt;&gt;<i> - 0-256B je rezervováno na data
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Abych øekl pravdu, vùbec jsem nevìdìl, jak zaèít. Nakonec jsem se pokusil pou¾ít modul struct a pøená¹e data zabalena pomoci toho modulu.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Pou¾il jsem tedy funkci struct.pack()
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> data = struct.pack(&quot;!IHHB256s&quot;, 0, 0, 0, 1, &quot;1&quot;)
</I>&gt;&gt;<i> s.sendto(data, (host, port))
</I>&gt;&gt;<i>
</I>&gt;<i> Mo¾ná je chyba zde. Jako data posílá¹ &quot;1&quot;, ale zabali¹ to jako &quot;1&quot; a za tím 255 znakù 0x00. To mo¾ná takto být nemá, zále¾í na zadání.
</I>&gt;<i>
</I>&gt;<i> Také pozor na endianitu. Vykøièníkem nastavuje¹ network/big-endian byte order, co¾ by mìlo být správnì, ale je mo¾né, ¾e server je naprogramovaný ¹patnì :)
</I>&gt;<i>
</I>&gt;&gt;<i> Jenom¾e tento zpùsob také nefunguje, proto¾e pokud po¹lu takto zabalenou zprávu referenènímu serveru, tak nedostanu odpovìï - tudí¾ server nepøeèetl paket správnì.
</I>&gt;<i> Zkus se tøeba tcpdumpem nebo wiresharkem (zmiòovaném v dal¹ím mailu) podívat, co pøesnì lítá po síti. Není mo¾né nìjak z toho serveru zjistit, co je ¹patnì? Má¹ ten server nìjak k dispozici?
</I>&gt;<i>
</I>&gt;&gt;<i> Prosím Vás tedy o nìjaký nápad, jak dál postupovat a jestli je napø. pou¾ití modulu struct vhodné.
</I>&gt;&gt;<i>
</I>&gt;<i> Modul struct je vhodný pøesnì na toto.
</I>&gt;<i>
</I>&gt;<i> PM
</I>&gt;<i>
</I>&gt;&gt;<i> Dìkuji za ka¾dou radu
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Jakub
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Python mailing list
</I>&gt;<i> <A HREF="http://www.py.cz/mailman/listinfo/python">Python na py.cz</A>
</I>&gt;<i> <A HREF="http://www.py.cz/mailman/listinfo/python">http://www.py.cz/mailman/listinfo/python</A>
</I>&gt;<i>
</I>------------- dal¹í èást ---------------
HTML pøíloha byla odstranìna...
URL: &lt;<A HREF="http://www.py.cz/pipermail/python/attachments/20120221/15254a87/attachment.html">http://www.py.cz/pipermail/python/attachments/20120221/15254a87/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-February/010565.html">[python] socket + udp + vytváøení paketù
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2012-February/010567.html">[python] socket + udp + vytváøení paketù
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2012-February/date.html#10566">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-February/thread.html#10566">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-February/subject.html#10566">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2012-February/author.html#10566">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2012-February/010566.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:17:38 GMT -->
</html>
