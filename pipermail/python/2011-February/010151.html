<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/python/2011-February/010151.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:18:08 GMT -->
<HEAD>
   <TITLE> [python] Dekorátor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20%3D%3Fiso-8859-2%3Fq%3FDekor%3DE1tor%3F%3D&In-Reply-To=%3C20110220160250.04bd8ae9%40amit.kihnet.sk%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/python/2011-February/010140.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/python/2011-February/010154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[python] Dekorátor</H1>
    <B>Róbert Èeròanský</B> 
    <A HREF="mailto:python%40py.cz?Subject=Re%3A%20%5Bpython%5D%20%3D%3Fiso-8859-2%3Fq%3FDekor%3DE1tor%3F%3D&In-Reply-To=%3C20110220160250.04bd8ae9%40amit.kihnet.sk%3E"
       TITLE="[python] Dekorátor">hslists na zoznam.sk
       </A><BR>
    <I>Nedìle Únor 20 16:02:50 CET 2011</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2011-February/010140.html">[python] Dekorátor
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2011-February/010154.html">[python] Dekorátor
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2011-February/date.html#10151">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2011-February/thread.html#10151">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2011-February/subject.html#10151">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2011-February/author.html#10151">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, 16 Feb 2011 06:23:07 -0800 (PST)
Radek &lt;<A HREF="http://www.py.cz/mailman/listinfo/python">radek.hnilica na gmail.com</A>&gt; wrote:

&gt;<i> Byl by tady nìkdo, kdo by mì mohl odkázat na rozumný studijní
</I>&gt;<i> materiál, podtrhuji rozumný, ze kterého bych byl schopen pochopit, jak
</I>&gt;<i> funguje dekorátor který definuju jako tøídu.  S dekorátory jako
</I>&gt;<i> funkcemi jsem se nìjak popasoval, tedy aspoò si to myslim, ale u té
</I>&gt;<i> tøídy je to pro mì èerná magie.
</I>
S tými rozumnými materiálmi je to bieda.  Hlavne sa mi zdá, ¾e
oficiálny Python Tutorial akosi zaostáva.  Pri niekoµkonásobnom
preèítaní relevantných (a roztrúsených) èastí oficiálnej dokumentácie
[1], [2], [3] a PEP 318 [4] sa to akosi dá pochopi».  Pokúsim sa to
vysvetli» ni¾sie.

&gt;<i> Pokud nemá dekorátor parametry, tak se zdá ¾e to nìjak chápu.  Do
</I>&gt;<i> __init__ je pøedána dekorovaná fuknce a do __call__ jsou pak pøedávány
</I>&gt;<i> argumenty té funkce viz:
</I>&gt;<i> 
</I>&gt;<i> class mydec:
</I>&gt;<i>     def __init__(self, fce):
</I>&gt;<i>         self.fce = fce   # Store, we will use it in __call__
</I>&gt;<i> 
</I>&gt;<i>     def __call__(self, *args, **kwds):
</I>&gt;<i>         ....pre
</I>&gt;<i>         result = self.fce(*args, **kwds)
</I>&gt;<i>         .....post
</I>&gt;<i>         return result
</I>&gt;<i> 
</I>&gt;<i> @mydec
</I>&gt;<i> def myfunc(*args, **kwds):
</I>&gt;<i>     pass
</I>&gt;<i> 
</I>&gt;<i> Ale pokud má mít dekorátor parametry, tak jsem sice na¹el/zkonstruoval
</I>&gt;<i> kód který se zdá fungovat, ale plnì mu nerozumím.
</I>[...]
&gt;<i> Jen tím ¾e chci aby mìl dekorátor parametry, se tak radikálnì zmìní
</I>&gt;<i> kód dekorátoru.
</I>&gt;<i> Potøeboval bych nìjak po lopatì vìdìt, co se uvnitø dìje, proto¾e
</I>&gt;<i> cítím ¾e ty dekorátory budu urèitì pou¾ívat je¹tì mnohem divoèeji.
</I>
Vo v¹eobecnosti je dekorátor funkcia, ktorá vracia funkciu.  V Pythone
je dekor&#225;tor &#8222;nie&#269;o, &#269;o sa d&#225; zavola&#357;&#8220; a po zavolan&#237; to vr&#225;ti tie&#382;
&#8222;nie&#269;o, &#269;o sa d&#225; zavola&#357;&#8220;.  To &#8222;nie&#269;o, &#269;o sa d&#225; zavola&#357;&#8220; je ak&#253;ko&#318;vek
objekt, ktor&#253; m&#225; met&#243;du __call__() &#8211; &#269;i&#382;e funkcia; trieda; in&#353;tancia
tredy, ktorá definuje __call__(); jedným slovom callable.  To prvé
callable reprezentuje samotný dekorátor a to druhé callable
reprezentuje, *v prípade dekorátora bez parametrov*, odekorovanú
funkciu (&#269;ize funkciu, ktor&#225; u&#382; je &#8222;oble&#269;en&#225;&#8220; do dekor&#225;tora).

Dekorátor (to, èo je za @) je volaný pri *definícii* funkcie, teda nie
pri jej zavolaní.  Pri tomto volaní sa vráti uz spomínané druhé
callable, ktoré reprezentuje odekorovanú funkciu (v prípade dekorátora
bez parametrov).  To je potom volané zaka¾dým, keï je volaná
dekorovaná funkcia (èi¾e tá, ktorá má nad sebou @).

_Dekorátor bez parametrov_, je zavolaný s jedným parametrom a tým je
dekorovaná funkcia.

Èi¾e keï zoberieme Tvoj príklad dekorátora bez parametrov, tak mydec
je zavolaný pri definícii myfunc() a dostane myfunc ako parameter.
Keï zoberieme do úvahy, ¾e mydec je trieda, tak jej zavolanie vlastne
znamená vytvorenie in¹tancie.  Táto vzniknutá in¹tancia má __call__()
a teda spåòa podmnienku, ¾e je callable.  Vniknutá in¹tancia teda
reprezentuje odekorovanú myfunc() a jej metóda __call__() je zavolaná
pri ka¾dom volaní myfunc().

_Dekorátor s parametrami_, je zavolaný iba s tými parametrami, s
ktorými bol nadefinovaný.  Èi¾e *nedostane dekorovanú funkciu*.
Callable, ktoré takýto dekorátor vráti reprezentuje *ïal¹í dekorátor*.
Tento &#271;al&#353;&#237; dekor&#225;tor, je u&#382; &#8222;norm&#225;lny&#8220; dekor&#225;tor bez parametrov
popísaný vy¹¹ie.  Je zavolaný tie¾ pri definícii funkcie (hneï za
dekorátorom s parametrami, ktorý ho vrátil) a dostane dekorovanú
funkciu ako parameter.

Dúfam, ¾e som «a e¹te viac nepoplietol. ;-)

[1] - <A HREF="http://docs.python.org/py3k/glossary.html#term-decorator">http://docs.python.org/py3k/glossary.html#term-decorator</A>
[2] -
<A HREF="http://docs.python.org/py3k/reference/compound_stmts.html#function">http://docs.python.org/py3k/reference/compound_stmts.html#function</A>
[3] -
<A HREF="http://docs.python.org/py3k/whatsnew/2.4.html?highlight=decorator">http://docs.python.org/py3k/whatsnew/2.4.html?highlight=decorator</A>

Robo


-- 
Robert Cernansky
E-mail: <A HREF="http://www.py.cz/mailman/listinfo/python">hslists na zoznam.sk</A>
Jabber: <A HREF="http://www.py.cz/mailman/listinfo/python">hs na jabber.sk</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2011-February/010140.html">[python] Dekorátor
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/python/2011-February/010154.html">[python] Dekorátor
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/python/2011-February/date.html#10151">[ data ]</a>
              <a href="http://www.py.cz/pipermail/python/2011-February/thread.html#10151">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/python/2011-February/subject.html#10151">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/python/2011-February/author.html#10151">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/python">Dal¹í informace o konferenci Python</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/python/2011-February/010151.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:18:08 GMT -->
</html>
