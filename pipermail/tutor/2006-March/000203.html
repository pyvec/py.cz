<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 
<!-- Mirrored from www.py.cz/pipermail/tutor/2006-March/000203.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:36:10 GMT -->
<HEAD>
   <TITLE> [Tutor PyCZ] Globalni,
	lokalni a volne promenno (bylo Dalsi problem s Livewires)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tutor%40py.cz?Subject=%5BTutor%20PyCZ%5D%20Globalni%2C%0A%09lokalni%20a%20volne%20promenno%20%28bylo%20Dalsi%20problem%20s%20Livewires%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=iso-8859-2">
   <LINK REL="Previous"  HREF="http://www.py.cz/pipermail/tutor/2006-March/000207.html">
   <LINK REL="Next"  HREF="http://www.py.cz/pipermail/tutor/2006-March/000210.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Tutor PyCZ] Globalni,
	lokalni a volne promenno (bylo Dalsi problem s Livewires)</H1>
    <B>Petr Prikryl</B> 
    <A HREF="mailto:tutor%40py.cz?Subject=%5BTutor%20PyCZ%5D%20Globalni%2C%0A%09lokalni%20a%20volne%20promenno%20%28bylo%20Dalsi%20problem%20s%20Livewires%29&In-Reply-To="
       TITLE="[Tutor PyCZ] Globalni,
	lokalni a volne promenno (bylo Dalsi problem s Livewires)">PrikrylP na skil.cz
       </A><BR>
    <I>Støeda Bøezen  1 09:19:21 CET 2006</I>
    <P><UL>
        <LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/tutor/2006-March/000207.html">[Tutor PyCZ] gui aplikace
</A></li>
        <LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/tutor/2006-March/000210.html">[Tutor PyCZ] Globalni,
	lokalni a volne promenno (bylo Dalsi problem s Livewires)
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/tutor/2006-March/date.html#203">[ data ]</a>
              <a href="http://www.py.cz/pipermail/tutor/2006-March/thread.html#203">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/tutor/2006-March/subject.html#203">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/tutor/2006-March/author.html#203">[ autora ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>geon
&gt;<i> Tomá¹ Bìlono¾ník napsal(a):
</I>&gt;<i> &gt; [...]
</I>&gt;<i> &gt; def posunHrace():
</I>&gt;<i> &gt;     stisky = keys_pressed()
</I>&gt;<i> &gt;     if &quot;2&quot; in stisky:
</I>&gt;<i> &gt;         yh = yh - 10
</I>&gt;<i> &gt;         move_to(Hrac_telo, xh, yh)
</I>&gt;<i> &gt;         return yh
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [...] Hází mi to ale chybu &quot;local variable 'yh' 
</I>&gt;<i> &gt; referenced before assignment&quot;. Chápu to
</I>&gt;<i> &gt; tak, ¾e jsem promìnnou yh zmínil je¹tì pøedtím, 
</I>&gt;<i> &gt; ne¾ jsem jí pøiøadil nìjakou hodnotu. Ale proè 
</I>&gt;<i> &gt; si tu hodnotu nevezme sám z vy¹¹ích pater
</I>&gt;<i> &gt; programu, jako to udìlal, kdy¾ øádek move_to vypadal
</I>&gt;<i> &gt; &quot;move_to(Hrac_telo, xh, yh-10)&quot;. 
</I>
&gt;<i> [...] Trocha teorie ode mne: nìkteré promìnné 
</I>&gt;<i> skuteènì funkce doká¾e brát zezhora - zde tøeba Hrac_telo 
</I>&gt;<i> nebo tvùj vý¹e uvádìný move_to(Hrac_telo, xh, yh-10). 
</I>&gt;<i> Jsou to ale vzdy jen ty promìnné, které se ve funkci 
</I>&gt;<i> nemìní - jsou tam jen jakoby read-only. Proto ti to 
</I>&gt;<i> házelo tu chybu, proto¾e jsi chtìl zmìnit read-only 
</I>&gt;<i> promìnnou.
</I>
Pokud ve funkci pou¾iji promìnnou a nesna¾ím
se do ní pøiøazovat, jde o takzvanou volnou promìnnou
(free variable). Volnou se nazývá proto, proto¾e
v bloku kódu neexistuje pevná vazba mezi jménem
'x' a konkrétním místem, kde je hodnota ulo¾ena.
V okam¾iku odkazu se teprve poloha &quot;ve vy¹¹ích patrech&quot;
bude zji¹»ovat.

Pokud do promìnné nìco pøiøadím, stává se lokální 
promìnnou v daném bloku kódu. Vyytváøí se pevná
vazba z mého lokálního prostoru. U¾ nemù¾eme hovoøit
o volné promìnné (tj. o promìnné definované nìkde
ve vy¹¹ích patrech). Pevná vazba na lokální prostor
se vytváøí i tehdy, kdy¾ se do této promìnné
pøiøazuje a¾ pozdìji (ve stejném bloku), ne¾ kdy¾ 
se z ní ète. Pøíklad:

soubor a.py 
=====================================
x = 10

def funkce1():
    print x

def funkce2():
    return x

print x            # (1)
funkce1()          # (2)
print funkce2()    # (3)
=====================================

Pøíkaz &quot;print x&quot; na øádku (1) vytiskne
podle oèekávání hodnotu 10. Jde o promìnnou
definovanou na stejné úrovni.

Na øádku (2) voláme funkce1() a ta se
v pøíkazu &quot;print x&quot; tiskne promìnou, která
je definována na &quot;vy¹¹í úrovni&quot;. Jde ale
o volnou promìnnou, která se postupnì hledá
v nadøízených lokálních prostorech (zde
¾ádné nemáme) a nakonec v prostoru globálním.

Na øádku (3) tiskneme výsledek, který získáváme
voláním funkce2(). V jejím tìle se pouze vrací
hodnota volné promìnné x. Jde o podobný pøípad,
jako u funkce1(). Hodnota promìnné x se pouze
zpracuje jiným zpùsobem.

Zkuste ale tohle:

soubor c.py 
=====================================
x = 10

def funkce3():
    x = x + 1
    print x

funkce3()
=====================================

Pøi pokusu o spu¹tìní se uká¾e toto...

C:\tmp&gt;python c.py
Traceback (most recent call last):
  File &quot;c.py&quot;, line 7, in ?
    funkce3()
  File &quot;c.py&quot;, line 4, in funkce3
    x = x + 1
UnboundLocalError: local variable 'x' referenced before assignment

Jak u¾ bylo uvedeno vý¹e, pøiøazení &quot;x = x + 1&quot; 
zpùsobí, ¾e funkce3 u¾ o promìnné x chce uva¾ovat
jako o lokální promìnné. Jen¾e tato lokální promìnná
je pou¾ita na pravé stranì pøiøazení a zatím jí
nebyla pøiøazena ¾ádná hodnota, tj. &quot;proveden
odkaz na lokální promìnnou 'x', které dosud nebylo 
nic pøiøazeno&quot;. Ona vlastnì promìnná x zatím 
neexistuje a chceme ji vytvoøit a pøiøadit
jí její neexistující hodnotu zvìt¹enou o jednièku.

Ve stejném bloku kódu oznaèuje jedno jméno
jen jednu promìnnou. Python nedovolí, abychom
se na tuto promìnnou dívali chvíli jako na volnou
promìnnou (vytvoøenou ve vy¹¹ích patrech) a o nìco
pozdìji jako na lokální promìnnou. Z tohoto dùvodu
sel¾e i následující pøíklad:

soubor d.py 
=====================================
x = 10

def funkce4():
    print x
    x = x + 1

funkce4()
=====================================

C:\tmp\a&gt;python d.py
Traceback (most recent call last):
  File &quot;d.py&quot;, line 7, in ?
    funkce4()
  File &quot;d.py&quot;, line 4, in funkce4
    print x
UnboundLocalError: local variable 'x' referenced before assignment

Tentokrát sel¾e u¾ pøíkaz &quot;print x&quot;, který
ve funkce1() normálnì fungoval. Tehdy jsme se
ale na x dívali jako na volnou promìnnou 
(definovanou jinde). Jen¾e pøíkaz &quot;x = x + 1&quot;
ve funkce4() zpùsobí, ¾e x nemù¾e být volnou
promìnnou. V okam¾iku definice funkce4() u¾ se
rozhodne o tom, ¾e x bude lokální promìnná
a nikdy jinak. Za tìchto okolností se na pøíkaz
&quot;print x&quot; pohlí¾í jako na pokus zobrazit obsah
dosud neexistující promìnné.

Pokud by Python nebyl tak pøísný a mìnil
by charakter promìnné z volné na lokální
a¾ podle potøeby, mohlo by to fungovat, 
ale pro èlovìka by se zdrojový text stával
nepøehledným a v komplikovanìj¹ích pøípadech 
by to mohlo vést k tì¾ko odhalitelným chybám. 
U¾ jen v pøípadì &quot;x = x + 1&quot; bychom vlastnì
nemohli øíci, co ten pøíkaz dìlá, proto¾e
bychom nemìli jistotu, ¾e se na obou stranách
pøiøazení pracuje se stejnou promìnnou x.

pepr
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Pøedchozí pøíspìvek: <A HREF="http://www.py.cz/pipermail/tutor/2006-March/000207.html">[Tutor PyCZ] gui aplikace
</A></li>
	<LI>Následující pøíspìvek: <A HREF="http://www.py.cz/pipermail/tutor/2006-March/000210.html">[Tutor PyCZ] Globalni,
	lokalni a volne promenno (bylo Dalsi problem s Livewires)
</A></li>
         <LI> <B>Zprávy tøídìné podle:</B> 
              <a href="http://www.py.cz/pipermail/tutor/2006-March/date.html#203">[ data ]</a>
              <a href="http://www.py.cz/pipermail/tutor/2006-March/thread.html#203">[ vlákna ]</a>
              <a href="http://www.py.cz/pipermail/tutor/2006-March/subject.html#203">[ subjektu ]</a>
              <a href="http://www.py.cz/pipermail/tutor/2006-March/author.html#203">[ autora ]</a>
         </LI>
       </UL>
<hr>
<a href="http://www.py.cz/mailman/listinfo/tutor">Dal¹í informace o konferenci Tutor</a><br>
</body>
<!-- Mirrored from www.py.cz/pipermail/tutor/2006-March/000203.html by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:36:10 GMT -->
</html>
