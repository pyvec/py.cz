<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en">
                         
  
<!-- Mirrored from www.py.cz/DekoratoryFuncii2/diff by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:02:38 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta http-equiv="Content-Type"
          content="text/html;charset=utf-8" />
    
    <link rel="stylesheet" type="text/css"
          href="../FrontPage/stylesheet.css" />
    <title>PyCZ: Programovací jazyk Python, aplikační servery a frameworky, atd. DekoratoryFuncii2</title>
    
    
    <meta name="robots" content="noindex,nofollow" />
  
  
  </head>
  <body>
    
    <div>
      <div id="pageheaderall" class="pageheader">
      <div id="accesskeys">
      <a accesskey="0"
         href="http://www.py.cz/DekoratoryFuncii2/helpaccesskeys"></a>
      <a accesskey="f" href="http://www.py.cz/FrontPage"></a>
      <a accesskey="c"
         href="http://www.py.cz/FrontPage/contents#DekoratoryFuncii2"></a>
      <a accesskey="r"
         href="http://www.py.cz/FrontPage/recentchanges"></a>
      <a accesskey="" href="http://www.py.cz/FrontPage"></a>
      
      <a accesskey="i"
         href="http://www.py.cz/FrontPage/wikiindex"></a>
      
      <a accesskey="o"
         href="http://www.py.cz/FrontPage/useroptions?redirectURL=http%3A//www.py.cz/DekoratoryFuncii2"></a>
      <a accesskey="h" href="http://www.py.cz/HelpPage"></a>
      
      
      <a accesskey="n"
         href="http://www.py.cz/GetSetProperty"></a>
      <a accesskey="p"
         href="http://www.py.cz/DekoratoryFunkcii"></a>
      <a accesskey="u" href="http://www.py.cz/OOP"></a>
      <a accesskey="v"
         href="http://www.py.cz/DekoratoryFuncii2"></a>
      <a accesskey="m"
         href="http://www.py.cz/DekoratoryFuncii2/subscribeform"></a>
      <a accesskey="b"
         href="http://www.py.cz/DekoratoryFuncii2/backlinks"></a>
      <a accesskey="d"
         href="http://www.py.cz/DekoratoryFuncii2/diff"></a>
      <a accesskey="y"
         href="http://www.py.cz/DekoratoryFuncii2/history"></a>
      <a accesskey="e"
         href="http://www.py.cz/DekoratoryFuncii2/editform"></a>
      
    </div>
      <div id="navlinks" class="linkpanel">
      <table class="shade1" width="100%" border="0" cellspacing="0">
        <tr>
          <td align="right">
            
      <a href="http://www.py.cz/FrontPage"
         title="show front page">
      <span>home</span></a>
      <a href="http://www.py.cz/FrontPage/contents#DekoratoryFuncii2"
         title="show wiki contents">
      <span>contents</span></a>
      <a href="http://www.py.cz/FrontPage/recentchanges"
         title="show wiki recent changes">
      <span>changes</span></a>
      
      <a title="show wiki index"
         href="http://www.py.cz/FrontPage/wikiindex">
      <span>index</span></a>
      
      <a title="show wiki options"
         href="http://www.py.cz/FrontPage/useroptions?redirectURL=http%3A//www.py.cz/DekoratoryFuncii2">
      <span>options</span></a>
      <a title="show help page"
         href="http://www.py.cz/HelpPage">
      <span>help</span></a>
    
            
      
      <a href="http://www.py.cz/DekoratoryFuncii2/subscribeform"
         title="configure email subscription to this page or site">
        
      <span>subscribe</span></a>
      
      <a href="http://www.py.cz/DekoratoryFuncii2/editform"
         title="edit-page (last edited 5 years ago by geon)">
      <span>edit</span></a>
      
    
          </td>
        </tr>
      </table>
    </div>
      <div id="pageheader">
        <form method="GET"
              action="http://www.py.cz/FrontPage/searchwiki">
          <table width="100%" border="0" cellspacing="0">
            <tr>
              <!-- logo -->
              <td id="logo" width="1%" valign="top"
                  class="logo">
                
                  <a title="go to home page"
                     href="http://www.py.cz/FrontPage">
                    
                    <img src="http://www.py.cz/DekoratoryFuncii2/logo.jpg" border="0" alt="home" />
                    
                  </a>
                  &nbsp;
                
              </td>
              <!-- page name and context (parent topics) -->
              <td align="left" width="79%">
                
                  <small><ul class="outline expandable">
 <li><a href="http://www.py.cz/PythonRoot" name="PythonRoot">PythonRoot</a>
<ul class="outline expandable">
  <li><a href="http://www.py.cz/OOP" name="OOP">OOP</a>
<ul class="outline expandable">
  <li><h1 style="display:inline;"><a href="http://www.py.cz/DekoratoryFuncii2/backlinks" title="which pages link to this one ?" name="DekoratoryFuncii2">DekoratoryFuncii2</a></h1></li>
</ul>
  </li>
</ul>
 </li>
</ul>
</small>
                
                
              </td>
              <!-- search form & page info -->
              <td class="searchbox" width="20%" align="right">
                
                  <input id="searchinput" class="formfield"
                         name="expr" type="text" size="20"
                         maxlength="100" value=""
                         title="search all pages" /><br />
                  <span class="lasteditor">last edited  <a href="http://www.py.cz/DekoratoryFuncii2/history" title="show last edit" >5 years</a> ago by <b>geon</b></span><br>
                  <span class="creator">created 2011-02-21</span>   
                
                
              </td>
            </tr>
          </table>
        </form>
      </div>
      <div id="ratingform" align="right">  
      <!-- page rating form -->
      <div>
        <a name="ratingform"></a>
        <style type="text/css">
          input.rating {border:none;}
        </style>
        <form method="POST" id="ratingform"
              action="http://www.py.cz/DekoratoryFuncii2/vote">
           <input type="image" name="vote0" value="0"
                  alt="0" class="rating" width="14"
                  height="13"
                  src="http://www.py.cz/p_/sp"
                  style=""
                  title="click to vote 0 (poor) for this page (0 votes)" /><input
    type="image" name="vote1" value="1" alt="1"
    class="rating" src="http://www.py.cz/DekoratoryFuncii2/misc_/ZWiki/star_icon" style=""
    title="click to vote 1 (average) for this page (0 votes)" /><input
    type="image" name="vote2" value="2" alt="2"
    class="rating" src="http://www.py.cz/DekoratoryFuncii2/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 2 (above average) for this page (0 votes)" /><input
    type="image" name="vote3" value="3" alt="3"
    class="rating" src="http://www.py.cz/DekoratoryFuncii2/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 3 (good) for this page (0 votes)" /><input
    type="image" name="vote4" value="4" alt="4"
    class="rating" src="http://www.py.cz/DekoratoryFuncii2/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 4 (great) for this page (0 votes)" /><input
    type="image" name="vote5" value="5" alt="5"
    class="rating" src="http://www.py.cz/DekoratoryFuncii2/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 5 (superb) for this page (0 votes)" />
        </form>
      </div>
    </div>
    </div>
      <h1>Edit detail for DekoratoryFuncii2 revision 1 of 1</h1>
      <div class="formcontent">
        <table border="0" cellspacing="0" width="100%">
          <tr valign="top">

            <td align="left">
              <form style="display:inline"
                    action="http://www.py.cz/DekoratoryFuncii2">
                <input type="submit" name="history:method"
                       value="Return to edit history" />
                
              </form>
            </td>

            <td align="center">
              <form style="display:inline"
                    action="http://www.py.cz/DekoratoryFuncii2/diff">
                <input type="hidden" name="rev" />
                
                <input disabled="1" value=" &lt; "
                       type="submit" accesskey="," />
              </form>
              <a style="font-weight:bold"
                 href="http://www.py.cz/DekoratoryFuncii2/diff?rev=1">1</a>
              <form style="display:inline"
                    action="http://www.py.cz/DekoratoryFuncii2/diff">
                <input type="hidden" name="rev" />
                
                <input disabled="1" value=" &gt; "
                       type="submit" accesskey="." />
              </form>
            </td>

            <td align="right">
              <form style="display:inline"
                    action="http://www.py.cz/DekoratoryFuncii2">
                <input type="hidden" name="rev" value="1" />
                <input value="Revert to this version"
                       type="submit" name="revert:method"
                       disabled="disabled" />
              </form>
            </td>

          </tr>
          <tr valign="top">
            <td colspan="3">
              <span>Editor:</span> geon
              <br />
              <span>Time:</span> 2011/02/21 22:21:41 GMT+1
            </td>
          </tr>
          <tr valign="top">
            <td colspan="3">
              <span>Note:</span> <span
    style="font-weight:bold; font-style:italic;"></span>
            </td>
          </tr>
        </table>
        <hr />
        <pre>
<b>changed:</b><span style="color:red;text-decoration:line-through">
-</span><span style="color:green">
Dotaz::

&gt; &gt; Byl by tady někdo, kdo by mě mohl odkázat na rozumný studijní
&gt; &gt; materiál, podtrhuji rozumný, ze kterého bych byl schopen pochopit, jak
&gt; &gt; funguje dekorátor který definuju jako třídu.  S dekorátory jako
&gt; &gt; funkcemi jsem se nějak popasoval, tedy aspoň si to myslim, ale u té
&gt; &gt; třídy je to pro mě černá magie.

Odpověď1:

S tými rozumnými materiálmi je to bieda.  Hlavne sa mi zdá, že
oficiálny Python Tutorial akosi zaostáva.  Pri niekoľkonásobnom
prečítaní relevantných (a roztrúsených) častí oficiálnej dokumentácie
[1]_, [2]_, [3]_ a PEP 318 [4]_ sa to akosi dá pochopiť.  Pokúsim sa to
vysvetliť nižsie.::

&gt; &gt; Pokud nemá dekorátor parametry, tak se zdá že to nějak chápu.  Do
&gt; &gt; __init__ je předána dekorovaná fuknce a do __call__ jsou pak předávány
&gt; &gt; argumenty té funkce viz:
&gt; &gt; 
&gt; &gt; class mydec:
&gt; &gt;     def __init__(self, fce):
&gt; &gt;         self.fce = fce   # Store, we will use it in __call__
&gt; &gt; 
&gt; &gt;     def __call__(self, *args, **kwds):
&gt; &gt;         ....pre
&gt; &gt;         result = self.fce(*args, **kwds)
&gt; &gt;         .....post
&gt; &gt;         return result
&gt; &gt; 
&gt; &gt; @mydec
&gt; &gt; def myfunc(*args, **kwds):
&gt; &gt;     pass
&gt; &gt; 
&gt; &gt; Ale pokud má mít dekorátor parametry, tak jsem sice našel/zkonstruoval
&gt; &gt; kód který se zdá fungovat, ale plně mu nerozumím.
&gt; &gt; Jen tím že chci aby měl dekorátor parametry, se tak radikálně změní
&gt; &gt; kód dekorátoru.
&gt; &gt; Potřeboval bych nějak po lopatě vědět, co se uvnitř děje, protože
&gt; &gt; cítím že ty dekorátory budu určitě používat ještě mnohem divočeji.

Vo všeobecnosti je dekorátor funkcia, ktorá vracia funkciu.  V Pythone
je dekorátor „niečo, čo sa dá zavolať“ a po zavolaní to vráti tiež
„niečo, čo sa dá zavolať“.  To „niečo, čo sa dá zavolať“ je akýkoľvek
objekt, ktorý má metódu __call__() – čiže funkcia; trieda; inštancia
tredy, ktorá definuje __call__(); jedným slovom callable.  To prvé
callable reprezentuje samotný dekorátor a to druhé callable
reprezentuje, *v prípade dekorátora bez parametrov*, odekorovanú
funkciu (čize funkciu, ktorá už je „oblečená“ do dekorátora).

Dekorátor (to, čo je za @) je volaný pri *definícii* funkcie, teda nie
pri jej zavolaní.  Pri tomto volaní sa vráti uz spomínané druhé
callable, ktoré reprezentuje odekorovanú funkciu (v prípade dekorátora
bez parametrov).  To je potom volané zakaždým, keď je volaná
dekorovaná funkcia (čiže tá, ktorá má nad sebou @).

Dekorátor bez parametrov, je zavolaný s jedným parametrom a tým je
dekorovaná funkcia.

Čiže keď zoberieme Tvoj príklad dekorátora bez parametrov, tak mydec
je zavolaný pri definícii myfunc() a dostane myfunc ako parameter.
Keď zoberieme do úvahy, že mydec je trieda, tak jej zavolanie vlastne
znamená vytvorenie inštancie.  Táto vzniknutá inštancia má __call__()
a teda spĺňa podmnienku, že je callable.  Vniknutá inštancia teda
reprezentuje odekorovanú myfunc() a jej metóda __call__() je zavolaná
pri každom volaní myfunc().

Dekorátor s parametrami, je zavolaný iba s tými parametrami, s
ktorými bol nadefinovaný.  Čiže *nedostane dekorovanú funkciu*.
Callable, ktoré takýto dekorátor vráti reprezentuje *ďalší dekorátor*.
Tento ďalší dekorátor, je už „normálny“ dekorátor bez parametrov
popísaný vyššie.  Je zavolaný tiež pri definícii funkcie (hneď za
dekorátorom s parametrami, ktorý ho vrátil) a dostane dekorovanú
funkciu ako parameter.

Dúfam, že som Ťa ešte viac nepoplietol. ;-)

.. [1] http://docs.python.org/py3k/glossary.html#term-decorator
.. [2] http://docs.python.org/py3k/reference/compound_stmts.html#function
.. [3] http://docs.python.org/py3k/whatsnew/2.4.html?highlight=decorator

---------------------------

Odpověď2:

jenom bych rad doplnil, ze pythoni syntaxe::

 @muj_dekorator
    def moje_funkce(*args): pass

je jenom syntakticky cukr a znamena to::

 moje_funkce = muj_dekorator(moje_funkce)

z cehoz je mozna mnohem jasnejsi, jak dekorator funguje.
alespon mne to tak dava vetsi smysl ;))



</span>
</pre>
        <hr />
        <div><p>Dotaz:</p>
<pre class="literal-block">
&gt; &gt; Byl by tady někdo, kdo by mě mohl odkázat na rozumný studijní
&gt; &gt; materiál, podtrhuji rozumný, ze kterého bych byl schopen pochopit, jak
&gt; &gt; funguje dekorátor který definuju jako třídu.  S dekorátory jako
&gt; &gt; funkcemi jsem se nějak popasoval, tedy aspoň si to myslim, ale u té
&gt; &gt; třídy je to pro mě černá magie.
</pre>
<p>Odpověď1:</p>
<p>S tými rozumnými materiálmi je to bieda.  Hlavne sa mi zdá, že
oficiálny Python Tutorial akosi zaostáva.  Pri niekoľkonásobnom
prečítaní relevantných (a roztrúsených) častí oficiálnej dokumentácie
<a class="footnote-reference" href="#id5" id="id1">[1]</a>, <a class="footnote-reference" href="#id6" id="id2">[2]</a>, <a class="footnote-reference" href="#id7" id="id3">[3]</a> a PEP 318 <a href="#id8"><span class="problematic" id="id9"><span id="id4"></span>[4]_</span></a> sa to akosi dá pochopiť.  Pokúsim sa to
vysvetliť nižsie.:</p>
<pre class="literal-block">
&gt; &gt; Pokud nemá dekorátor parametry, tak se zdá že to nějak chápu.  Do
&gt; &gt; __init__ je předána dekorovaná fuknce a do __call__ jsou pak předávány
&gt; &gt; argumenty té funkce viz:
&gt; &gt;
&gt; &gt; class mydec:
&gt; &gt;     def __init__(self, fce):
&gt; &gt;         self.fce = fce   # Store, we will use it in __call__
&gt; &gt;
&gt; &gt;     def __call__(self, *args, **kwds):
&gt; &gt;         ....pre
&gt; &gt;         result = self.fce(*args, **kwds)
&gt; &gt;         .....post
&gt; &gt;         return result
&gt; &gt;
&gt; &gt; &#64;mydec
&gt; &gt; def myfunc(*args, **kwds):
&gt; &gt;     pass
&gt; &gt;
&gt; &gt; Ale pokud má mít dekorátor parametry, tak jsem sice našel/zkonstruoval
&gt; &gt; kód který se zdá fungovat, ale plně mu nerozumím.
&gt; &gt; Jen tím že chci aby měl dekorátor parametry, se tak radikálně změní
&gt; &gt; kód dekorátoru.
&gt; &gt; Potřeboval bych nějak po lopatě vědět, co se uvnitř děje, protože
&gt; &gt; cítím že ty dekorátory budu určitě používat ještě mnohem divočeji.
</pre>
<p>Vo všeobecnosti je dekorátor funkcia, ktorá vracia funkciu.  V Pythone
je dekorátor „niečo, čo sa dá zavolať“ a po zavolaní to vráti tiež
„niečo, čo sa dá zavolať“.  To „niečo, čo sa dá zavolať“ je akýkoľvek
objekt, ktorý má metódu __call__() – čiže funkcia; trieda; inštancia
tredy, ktorá definuje __call__(); jedným slovom callable.  To prvé
callable reprezentuje samotný dekorátor a to druhé callable
reprezentuje, <em>v prípade dekorátora bez parametrov</em>, odekorovanú
funkciu (čize funkciu, ktorá už je „oblečená“ do dekorátora).</p>
<p>Dekorátor (to, čo je za &#64;) je volaný pri <em>definícii</em> funkcie, teda nie
pri jej zavolaní.  Pri tomto volaní sa vráti uz spomínané druhé
callable, ktoré reprezentuje odekorovanú funkciu (v prípade dekorátora
bez parametrov).  To je potom volané zakaždým, keď je volaná
dekorovaná funkcia (čiže tá, ktorá má nad sebou &#64;).</p>
<p>Dekorátor bez parametrov, je zavolaný s jedným parametrom a tým je
dekorovaná funkcia.</p>
<p>Čiže keď zoberieme Tvoj príklad dekorátora bez parametrov, tak mydec
je zavolaný pri definícii myfunc() a dostane myfunc ako parameter.
Keď zoberieme do úvahy, že mydec je trieda, tak jej zavolanie vlastne
znamená vytvorenie inštancie.  Táto vzniknutá inštancia má __call__()
a teda spĺňa podmnienku, že je callable.  Vniknutá inštancia teda
reprezentuje odekorovanú myfunc() a jej metóda __call__() je zavolaná
pri každom volaní myfunc().</p>
<p>Dekorátor s parametrami, je zavolaný iba s tými parametrami, s
ktorými bol nadefinovaný.  Čiže <em>nedostane dekorovanú funkciu</em>.
Callable, ktoré takýto dekorátor vráti reprezentuje <em>ďalší dekorátor</em>.
Tento ďalší dekorátor, je už „normálny“ dekorátor bez parametrov
popísaný vyššie.  Je zavolaný tiež pri definícii funkcie (hneď za
dekorátorom s parametrami, ktorý ho vrátil) a dostane dekorovanú
funkciu ako parameter.</p>
<p>Dúfam, že som Ťa ešte viac nepoplietol. ;-)</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://docs.python.org/py3k/glossary.html#term-decorator">http://docs.python.org/py3k/glossary.html#term-decorator</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://docs.python.org/py3k/reference/compound_stmts.html#function">http://docs.python.org/py3k/reference/compound_stmts.html#function</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://docs.python.org/py3k/whatsnew/2.4.html?highlight=decorator">http://docs.python.org/py3k/whatsnew/2.4.html?highlight=decorator</a></td></tr>
</tbody>
</table>
<hr class="docutils" />
<p>Odpověď2:</p>
<p>jenom bych rad doplnil, ze pythoni syntaxe:</p>
<pre class="literal-block">
&#64;muj_dekorator
   def moje_funkce(*args): pass
</pre>
<p>je jenom syntakticky cukr a znamena to:</p>
<pre class="literal-block">
moje_funkce = muj_dekorator(moje_funkce)
</pre>
<p>z cehoz je mozna mnohem jasnejsi, jak dekorator funguje.
alespon mne to tak dava vetsi smysl ;))</p>
<p>
</p>
</div>
      </div>
    </div>
    
  </body>

<!-- Mirrored from www.py.cz/DekoratoryFuncii2/diff by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:02:38 GMT -->
</html>

