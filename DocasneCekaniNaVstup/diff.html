<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en">
                         
  
<!-- Mirrored from www.py.cz/DocasneCekaniNaVstup/diff by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:03:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta http-equiv="Content-Type"
          content="text/html;charset=utf-8" />
    
    <link rel="stylesheet" type="text/css"
          href="../FrontPage/stylesheet.css" />
    <title>PyCZ: Programovací jazyk Python, aplikační servery a frameworky, atd. DocasneCekaniNaVstup</title>
    
    
    <meta name="robots" content="noindex,nofollow" />
  
  
  </head>
  <body>
    
    <div>
      <div id="pageheaderall" class="pageheader">
      <div id="accesskeys">
      <a accesskey="0"
         href="http://www.py.cz/DocasneCekaniNaVstup/helpaccesskeys"></a>
      <a accesskey="f" href="http://www.py.cz/FrontPage"></a>
      <a accesskey="c"
         href="http://www.py.cz/FrontPage/contents#DocasneCekaniNaVstup"></a>
      <a accesskey="r"
         href="http://www.py.cz/FrontPage/recentchanges"></a>
      <a accesskey="" href="http://www.py.cz/FrontPage"></a>
      
      <a accesskey="i"
         href="http://www.py.cz/FrontPage/wikiindex"></a>
      
      <a accesskey="o"
         href="http://www.py.cz/FrontPage/useroptions?redirectURL=http%3A//www.py.cz/DocasneCekaniNaVstup"></a>
      <a accesskey="h" href="http://www.py.cz/HelpPage"></a>
      
      
      <a accesskey="n"
         href="http://www.py.cz/FormatovaniRetezcu"></a>
      <a accesskey="p" href="http://www.py.cz/Chameleon"></a>
      <a accesskey="u" href="http://www.py.cz/TipyTriky"></a>
      <a accesskey="v"
         href="http://www.py.cz/DocasneCekaniNaVstup"></a>
      <a accesskey="m"
         href="http://www.py.cz/DocasneCekaniNaVstup/subscribeform"></a>
      <a accesskey="b"
         href="http://www.py.cz/DocasneCekaniNaVstup/backlinks"></a>
      <a accesskey="d"
         href="http://www.py.cz/DocasneCekaniNaVstup/diff"></a>
      <a accesskey="y"
         href="http://www.py.cz/DocasneCekaniNaVstup/history"></a>
      <a accesskey="e"
         href="http://www.py.cz/DocasneCekaniNaVstup/editform"></a>
      
    </div>
      <div id="navlinks" class="linkpanel">
      <table class="shade1" width="100%" border="0" cellspacing="0">
        <tr>
          <td align="right">
            
      <a href="http://www.py.cz/FrontPage"
         title="show front page">
      <span>home</span></a>
      <a href="http://www.py.cz/FrontPage/contents#DocasneCekaniNaVstup"
         title="show wiki contents">
      <span>contents</span></a>
      <a href="http://www.py.cz/FrontPage/recentchanges"
         title="show wiki recent changes">
      <span>changes</span></a>
      
      <a title="show wiki index"
         href="http://www.py.cz/FrontPage/wikiindex">
      <span>index</span></a>
      
      <a title="show wiki options"
         href="http://www.py.cz/FrontPage/useroptions?redirectURL=http%3A//www.py.cz/DocasneCekaniNaVstup">
      <span>options</span></a>
      <a title="show help page"
         href="http://www.py.cz/HelpPage">
      <span>help</span></a>
    
            
      
      <a href="http://www.py.cz/DocasneCekaniNaVstup/subscribeform"
         title="configure email subscription to this page or site">
        
      <span>subscribe</span></a>
      
      <a href="http://www.py.cz/DocasneCekaniNaVstup/editform"
         title="edit-page (last edited 4 years ago by pycz)">
      <span>edit</span></a>
      
    
          </td>
        </tr>
      </table>
    </div>
      <div id="pageheader">
        <form method="GET"
              action="http://www.py.cz/FrontPage/searchwiki">
          <table width="100%" border="0" cellspacing="0">
            <tr>
              <!-- logo -->
              <td id="logo" width="1%" valign="top"
                  class="logo">
                
                  <a title="go to home page"
                     href="http://www.py.cz/FrontPage">
                    
                    <img src="http://www.py.cz/DocasneCekaniNaVstup/logo.jpg" border="0" alt="home" />
                    
                  </a>
                  &nbsp;
                
              </td>
              <!-- page name and context (parent topics) -->
              <td align="left" width="79%">
                
                  <small><ul class="outline expandable">
 <li><a href="http://www.py.cz/PythonRoot" name="PythonRoot">PythonRoot</a>
<ul class="outline expandable">
  <li><a href="http://www.py.cz/TipyTriky" name="TipyTriky">TipyTriky</a>
<ul class="outline expandable">
  <li><h1 style="display:inline;"><a href="http://www.py.cz/DocasneCekaniNaVstup/backlinks" title="which pages link to this one ?" name="DocasneCekaniNaVstup">DocasneCekaniNaVstup</a></h1></li>
</ul>
  </li>
</ul>
 </li>
</ul>
</small>
                
                
              </td>
              <!-- search form & page info -->
              <td class="searchbox" width="20%" align="right">
                
                  <input id="searchinput" class="formfield"
                         name="expr" type="text" size="20"
                         maxlength="100" value=""
                         title="search all pages" /><br />
                  <span class="lasteditor">last edited  <a href="http://www.py.cz/DocasneCekaniNaVstup/history" title="show last edit" >4 years</a> ago by <b>pycz</b></span><br>
                  <span class="creator">created 2007-09-16</span>   
                
                
              </td>
            </tr>
          </table>
        </form>
      </div>
      <div id="ratingform" align="right">  
      <!-- page rating form -->
      <div>
        <a name="ratingform"></a>
        <style type="text/css">
          input.rating {border:none;}
        </style>
        <form method="POST" id="ratingform"
              action="http://www.py.cz/DocasneCekaniNaVstup/vote">
           <input type="image" name="vote0" value="0"
                  alt="0" class="rating" width="14"
                  height="13"
                  src="http://www.py.cz/p_/sp"
                  style=""
                  title="click to vote 0 (poor) for this page (0 votes)" /><input
    type="image" name="vote1" value="1" alt="1"
    class="rating" src="http://www.py.cz/DocasneCekaniNaVstup/misc_/ZWiki/star_icon" style=""
    title="click to vote 1 (average) for this page (0 votes)" /><input
    type="image" name="vote2" value="2" alt="2"
    class="rating" src="http://www.py.cz/DocasneCekaniNaVstup/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 2 (above average) for this page (0 votes)" /><input
    type="image" name="vote3" value="3" alt="3"
    class="rating" src="http://www.py.cz/DocasneCekaniNaVstup/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 3 (good) for this page (0 votes)" /><input
    type="image" name="vote4" value="4" alt="4"
    class="rating" src="http://www.py.cz/DocasneCekaniNaVstup/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 4 (great) for this page (0 votes)" /><input
    type="image" name="vote5" value="5" alt="5"
    class="rating" src="http://www.py.cz/DocasneCekaniNaVstup/misc_/ZWiki/blank_star_icon"
    style=""
    title="click to vote 5 (superb) for this page (0 votes)" />
        </form>
      </div>
    </div>
    </div>
      <h1>Edit detail for DocasneCekaniNaVstup revision 2 of 1</h1>
      <div class="formcontent">
        <table border="0" cellspacing="0" width="100%">
          <tr valign="top">

            <td align="left">
              <form style="display:inline"
                    action="http://www.py.cz/DocasneCekaniNaVstup">
                <input type="submit" name="history:method"
                       value="Return to edit history" />
                
              </form>
            </td>

            <td align="center">
              <form style="display:inline"
                    action="http://www.py.cz/DocasneCekaniNaVstup/diff">
                <input type="hidden" name="rev" />
                
                <input disabled="1" value=" &lt; "
                       type="submit" accesskey="," />
              </form>
              <a style="font-weight:bold"
                 href="http://www.py.cz/DocasneCekaniNaVstup/diff?rev=2">2</a>
              <form style="display:inline"
                    action="http://www.py.cz/DocasneCekaniNaVstup/diff">
                <input type="hidden" name="rev" />
                
                <input disabled="1" value=" &gt; "
                       type="submit" accesskey="." />
              </form>
            </td>

            <td align="right">
              <form style="display:inline"
                    action="http://www.py.cz/DocasneCekaniNaVstup">
                <input type="hidden" name="rev" value="2" />
                <input value="Revert to this version"
                       type="submit" name="revert:method"
                       disabled="disabled" />
              </form>
            </td>

          </tr>
          <tr valign="top">
            <td colspan="3">
              <span>Editor:</span> pycz
              <br />
              <span>Time:</span> 2011/10/15 12:15:20 GMT+2
            </td>
          </tr>
          <tr valign="top">
            <td colspan="3">
              <span>Note:</span> <span
    style="font-weight:bold; font-style:italic;">pridavani znacek 2x-3x</span>
            </td>
          </tr>
        </table>
        <hr />
        <pre>
<b>changed:</b><span style="color:red;text-decoration:line-through">
-</span><span style="color:green">
.. image:: py30.png
   :align: right
   
Dočasné čekání na vstup
========================

*Vytaženo a upraveno z konference*

Dotaz
-----
Ahoj, potřebuji aby když uživatel neodpoví na výzvu *input()* do 5 sekund, aby čekání na odpověď skončilo a dosadila se nějaké defaultní hodnota.

Obecná odpověď
-----------------

Zdravím, Nejjednodušší (a nejelegantnější) by bylo použití funkce alarm a obsluhy SIGALRM, ale to je možné pouze na rozumných OS, které vyhovují normě
POSIX (což by správně měly všechny systémy, ale nic není ideální...).
Další možností by bylo použití funkce select, ale to také na OS, který
nejmenujeme, nepůjde (tam funguje select jen se sockety). Možná by šlo
určitým způsobem využít nonblocking IO, ale to by nejspíš vyžadovalo
pywin32 knihovny a nevím, jaká je úroveň podpory této funkce v technicky
nedokonalých systémech. Řešení přes thready mi přijde docela
komplikované a nespolehlivé, hlavně je otázkou přerušení raw_input
funkce (možná by šlo použít něco jako externí interrupt vlákna, ale
taktéž nevím, do jaké míry je tato funkce spolehlivá). Takže odpověď
není jednoznačná, můžete vyzkoušet různé postupy, v případě zájmu o
podrobnosti se ozvěte.

GUI
----
Ne, nepotrebujes input(), potrebujes od uzivatele nejak *zadat
hodnotu*. Tohle upresneni je pomerne zasadni :). Preruseni input()
muze byt IMHO totiz pomerne problematicke. Na Tvem miste bych zkusil
pouzit nejaky toolkit pro vytvareni TUI (textovych user interface),
treba (n)curses nebo slang nebo GUI (Tkinter, PyGTK, ...).

Windows
--------
Není bez chyby, není takový jaký by měl, ale alespon neco. Jakmile 
napíšeš jediné písmeno, už není možno ukončit vlákno po zadané době. Problém totiž je, že nejde násilně ukončit vlákno, které čeká na obyčejném *input()*

::
  
  import threading, queue, time
  import msvcrt # Jen pro MS Windows
  
  vystup = queue.Queue()
  zamek = threading.Lock()
  
  def vlakno1():
      time.sleep(5)
      vystup.put('konec')
  
  def vlakno2():
      print (&quot;Ocekavam vstup: &quot;)
      while nasloucham.isAlive():
          if msvcrt.kbhit():
              zamek.acquire()
              vystup.put(input())
              zamek.release()
  
  nasloucham = threading.Thread(target = vlakno1)
  cekamvstup = threading.Thread(target = vlakno2)
  nasloucham.start()
  cekamvstup.start()
  while nasloucham.isAlive() or not vystup.empty():
      if not zamek.locked() and not vystup.empty():
          print (vystup.get() )

Linux
------
Zaprvé píšu s křížkem po funuse a zadruhé tohle řešení bude fungovat jen 
na Operačních systémech, což už poznamenal regnarG. Takže si toho 
nevšímejte  :-) :: 

   #!/usr/bin/python
  
   import sys, select
   r = select.select([sys.stdin], [], [], 5)
   if r[0]:
        choice = sys.stdin.readline()
   else:
        choice = 'default\n'
   print 'Tvoje volba:', choice



</span>
</pre>
        <hr />
        <div><img alt="py30.png" class="align-right" src="http://www.py.cz/DocasneCekaniNaVstup/py30.png" />
<div class="section" id="docasne-cekani-na-vstup">
<h2>Dočasné čekání na vstup</h2>
<p><em>Vytaženo a upraveno z konference</em></p>
<div class="section" id="dotaz">
<h3>Dotaz</h3>
<p>Ahoj, potřebuji aby když uživatel neodpoví na výzvu <em>input()</em> do 5 sekund, aby čekání na odpověď skončilo a dosadila se nějaké defaultní hodnota.</p>
</div>
<div class="section" id="obecna-odpoved">
<h3>Obecná odpověď</h3>
<p>Zdravím, Nejjednodušší (a nejelegantnější) by bylo použití funkce alarm a obsluhy SIGALRM, ale to je možné pouze na rozumných OS, které vyhovují normě
POSIX (což by správně měly všechny systémy, ale nic není ideální...).
Další možností by bylo použití funkce select, ale to také na OS, který
nejmenujeme, nepůjde (tam funguje select jen se sockety). Možná by šlo
určitým způsobem využít nonblocking IO, ale to by nejspíš vyžadovalo
pywin32 knihovny a nevím, jaká je úroveň podpory této funkce v technicky
nedokonalých systémech. Řešení přes thready mi přijde docela
komplikované a nespolehlivé, hlavně je otázkou přerušení raw_input
funkce (možná by šlo použít něco jako externí interrupt vlákna, ale
taktéž nevím, do jaké míry je tato funkce spolehlivá). Takže odpověď
není jednoznačná, můžete vyzkoušet různé postupy, v případě zájmu o
podrobnosti se ozvěte.</p>
</div>
<div class="section" id="gui">
<h3>GUI</h3>
<p>Ne, nepotrebujes input(), potrebujes od uzivatele nejak <em>zadat
hodnotu</em>. Tohle upresneni je pomerne zasadni :). Preruseni input()
muze byt IMHO totiz pomerne problematicke. Na Tvem miste bych zkusil
pouzit nejaky toolkit pro vytvareni TUI (textovych user interface),
treba (n)curses nebo slang nebo GUI (Tkinter, <a href="http://www.py.cz/PyGTK">PyGTK</a>, ...).</p>
</div>
<div class="section" id="windows">
<h3>Windows</h3>
<p>Není bez chyby, není takový jaký by měl, ale alespon neco. Jakmile
napíšeš jediné písmeno, už není možno ukončit vlákno po zadané době. Problém totiž je, že nejde násilně ukončit vlákno, které čeká na obyčejném <em>input()</em></p>
<pre class="literal-block">
import threading, queue, time
import msvcrt # Jen pro MS Windows

vystup = queue.Queue()
zamek = threading.Lock()

def vlakno1():
    time.sleep(5)
    vystup.put('konec')

def vlakno2():
    print (&quot;Ocekavam vstup: &quot;)
    while nasloucham.isAlive():
        if msvcrt.kbhit():
            zamek.acquire()
            vystup.put(input())
            zamek.release()

nasloucham = threading.Thread(target = vlakno1)
cekamvstup = threading.Thread(target = vlakno2)
nasloucham.start()
cekamvstup.start()
while nasloucham.isAlive() or not vystup.empty():
    if not zamek.locked() and not vystup.empty():
        print (vystup.get() )
</pre>
</div>
<div class="section" id="linux">
<h3>Linux</h3>
<p>Zaprvé píšu s křížkem po funuse a zadruhé tohle řešení bude fungovat jen
na Operačních systémech, což už poznamenal regnarG. Takže si toho
nevšímejte  :-)</p>
<pre class="literal-block">
#!/usr/bin/python

import sys, select
r = select.select([sys.stdin], [], [], 5)
if r[0]:
     choice = sys.stdin.readline()
else:
     choice = 'default\n'
print 'Tvoje volba:', choice
</pre>
<p>
</p>
</div>
</div>
</div>
      </div>
    </div>
    
  </body>

<!-- Mirrored from www.py.cz/DocasneCekaniNaVstup/diff by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 20 Mar 2016 21:03:54 GMT -->
</html>

